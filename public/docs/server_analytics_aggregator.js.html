<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>server/analytics/aggregator.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* Dark theme matching app style - carefully scoped to not break layout */
        html, body {
            background-color: #1a1a1a !important;
            color: #e0e0e0 !important;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important;
            overflow-x: hidden !important;
            margin: 0 !important;
            padding: 0 !important;
        }

        /* Ultra-thin scrollbar with gradient - all webkit browsers */
        ::-webkit-scrollbar {
            width: 5px;
            height: 5px;
            background: #1a1a1a;
        }

        ::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 2px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #60a5fa 0%, #a78bfa 100%);
            border-radius: 2px;
            border: 1px solid #1a1a1a;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #93c5fd 0%, #c4b5fd 100%);
        }

        ::-webkit-scrollbar-corner {
            background: #1a1a1a;
        }

        ::-webkit-scrollbar-button {
            display: none;
            width: 0;
            height: 0;
        }

        /* Specific elements scrollbars */
        body::-webkit-scrollbar,
        nav::-webkit-scrollbar,
        #main::-webkit-scrollbar,
        .container-overview::-webkit-scrollbar,
        pre::-webkit-scrollbar {
            width: 5px;
            height: 5px;
            background: #1a1a1a;
        }

        body::-webkit-scrollbar-thumb,
        nav::-webkit-scrollbar-thumb,
        #main::-webkit-scrollbar-thumb,
        .container-overview::-webkit-scrollbar-thumb,
        pre::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #60a5fa 0%, #a78bfa 100%);
            border-radius: 2px;
            border: 1px solid #1a1a1a;
        }

        body::-webkit-scrollbar-thumb:hover,
        nav::-webkit-scrollbar-thumb:hover,
        #main::-webkit-scrollbar-thumb:hover,
        .container-overview::-webkit-scrollbar-thumb:hover,
        pre::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #93c5fd 0%, #c4b5fd 100%);
        }

        /* Navigation sidebar - remove padding and white borders */
        nav {
            background-color: #242424 !important;
            border-right: 1px solid #404040 !important;
            padding: 0 !important;
            margin: 0 !important;
            overflow-x: hidden !important;
        }

        /* Nav scrollbar - explicit override */
        nav::-webkit-scrollbar {
            width: 5px !important;
            height: 5px !important;
            background: #242424 !important;
        }

        nav::-webkit-scrollbar-track {
            background: #242424 !important;
        }

        nav::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #60a5fa 0%, #a78bfa 100%) !important;
            border-radius: 2px !important;
        }

        nav::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #93c5fd 0%, #c4b5fd 100%) !important;
        }

        nav h2, nav h3 {
            color: #e0e0e0 !important;
            border-bottom: 1px solid #404040 !important;
            padding: 10px 15px !important;
            margin: 0 !important;
            background-color: #242424 !important;
            font-size: 14px !important;
            font-weight: 600 !important;
        }

        nav h3 {
            font-size: 13px !important;
        }

        nav ul {
            padding: 0 !important;
            margin: 0 !important;
            background-color: #242424 !important;
        }

        nav ul li {
            list-style: none !important;
            margin: 0 !important;
            padding: 0 !important;
            background-color: #242424 !important;
        }

        nav ul li a {
            color: #c9d1d9 !important;
            display: block !important;
            padding: 8px 15px !important;
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            background-color: #242424 !important;
            margin: 0 !important;
            border: none !important;
            font-size: 14px !important;
        }

        nav ul li a:hover {
            color: #60a5fa !important;
            background-color: rgba(96, 165, 250, 0.1) !important;
        }

        /* Module links (direct children of nav > ul > li) */
        nav > ul > li > a {
            color: #60a5fa !important;
            font-weight: 600 !important;
            padding: 10px 15px !important;
            font-size: 14px !important;
            border-left: 3px solid #60a5fa !important;
            padding-left: 12px !important;
        }

        nav > ul > li > a:hover {
            background-color: rgba(96, 165, 250, 0.15) !important;
        }

        /* Sub-items (methods/functions) indented */
        nav ul.methods {
            padding-left: 15px !important;
        }

        nav ul.methods li a {
            color: #9ca3af !important;
            font-size: 13px !important;
            padding: 6px 15px !important;
            font-weight: 400 !important;
        }

        nav ul.methods li a:hover {
            color: #c9d1d9 !important;
        }

        nav > h2:first-child {
            font-size: 16px !important;
            font-weight: 700 !important;
            padding: 12px 15px !important;
        }

        /* Main content area - dark background */
        #main {
            background-color: #1a1a1a !important;
            padding: 20px !important;
        }

        /* Article and sections - ensure dark background */
        article, section, .container-overview, .description {
            background-color: #1a1a1a !important;
        }

        /* Images - style demo images */
        img {
            max-width: 100% !important;
            height: auto !important;
            border: 1px solid #404040 !important;
            border-radius: 8px !important;
            margin: 20px 0 !important;
        }

        /* Links */
        a {
            color: #60a5fa !important;
            text-decoration: none !important;
        }

        a:hover {
            color: #93c5fd !important;
            text-decoration: underline !important;
        }

        /* Headings */
        h1, h2, h3, h4, h5, h6 {
            color: #e0e0e0 !important;
            border-bottom-color: #404040 !important;
            background-color: transparent !important;
        }

        h4.name {
            background-color: #2a2a2a !important;
            border: 1px solid #404040 !important;
        }

        /* Code blocks */
        pre {
            background-color: #0d1117 !important;
            border: 1px solid #404040 !important;
        }

        pre code {
            background-color: transparent !important;
        }

        code {
            background-color: #2a2a2a !important;
            color: #e0e0e0 !important;
            padding: 2px 6px !important;
            border-radius: 3px !important;
        }

        /* Tables */
        table {
            border-color: #404040 !important;
            background-color: #1a1a1a !important;
        }

        table thead tr {
            background-color: #242424 !important;
        }

        table tbody tr {
            background-color: #1a1a1a !important;
        }

        table tbody tr:nth-child(even) {
            background-color: #1f1f1f !important;
        }

        table td, table th {
            border-color: #404040 !important;
            color: #e0e0e0 !important;
            background-color: transparent !important;
        }

        .params .name, .props .name {
            color: #10b981 !important;
            font-family: 'Courier New', monospace !important;
        }

        /* Descriptions and details */
        .description, .details, dt, dd, p, ul, ol, dl {
            color: #e0e0e0 !important;
            background-color: transparent !important;
        }

        /* Types */
        .type-signature {
            color: #a78bfa !important;
        }

        /* Source links */
        .details .details-item-container {
            border-left-color: #404040 !important;
        }

        /* Breadcrumbs */
        .page-title {
            color: #e0e0e0 !important;
        }

        /* Search */
        #nav-search {
            background-color: #2a2a2a !important;
            border: 1px solid #404040 !important;
            color: #e0e0e0 !important;
        }

        /* Mobile nav trigger */
        .navicon-button {
            background-color: #2a2a2a !important;
        }

        /* Footer */
        footer {
            background-color: #1a1a1a !important;
            color: #9ca3af !important;
            border-top: 1px solid #404040 !important;
            text-align: center !important;
            padding: 20px !important;
        }

        /* Remove horizontal scrollbar and white borders */
        * {
            box-sizing: border-box !important;
        }
    </style>
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h3>Home</h3><ul><li><a href="index.html">README</a></li></ul><h3>ShippingManager</h3><ul><li><a href="tutorial-03-discovered-formulars.html">Discovered Formulas</a></li></ul><h3>COPILOT Tutorials</h3><ul><li><a href="tutorial-01-installation-guide.html">Installation</a></li><li><a href="tutorial-02-build-guide.html">Build Guide</a></li><li><a href="tutorial-04-cheatsheet.html">Cheat-Sheet</a></li><li><a href="tutorial-05-beginners-guide.html">Beginners Guide</a></li><li><a href="tutorial-06-api-reference.html">API Reference</a></li></ul><h3>COPILOT DOCUMENTATION</h3><ul><li class="nav-list-toggle"><a>Classes</a><ul style="display: none;"><li><a href="module-core_debounced-api.DebouncedAPIManager.html">DebouncedAPIManager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_debounced-api.DebouncedAPIManager.html#call">call</a></li><li data-type='method' style='display: none;'><a href="module-core_debounced-api.DebouncedAPIManager.html#cancelAll">cancelAll</a></li><li data-type='method' style='display: none;'><a href="module-core_debounced-api.DebouncedAPIManager.html#get">get</a></li><li data-type='method' style='display: none;'><a href="module-core_debounced-api.DebouncedAPIManager.html#register">register</a></li></ul></li><li><a href="module-server_chatbot-ChatBot.html">ChatBot</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_chatbot-ChatBot.html#initialize">initialize</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot-ChatBot.html#processAllianceMessage">processAllianceMessage</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot-ChatBot.html#processPrivateMessage">processPrivateMessage</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot-ChatBot.html#setupScheduledTasks">setupScheduledTasks</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot-ChatBot.html#updateSettings">updateSettings</a></li></ul></li></ul></li><li class="nav-list-toggle"><a>Modules</a><ul style="display: none;"><li><a href="module-alliance-tabs.html">alliance-tabs</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.clearAllianceTabCache">clearAllianceTabCache</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.closeAllianceCoopOverlay">closeAllianceCoopOverlay</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.getCurrentTab">getCurrentTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.hideAllAllianceUI">hideAllAllianceUI</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.initAllianceTabs">initAllianceTabs</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.refreshCurrentTab">refreshCurrentTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.showAllAllianceUI">showAllAllianceUI</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.showAllianceCoopOverlay">showAllianceCoopOverlay</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.showAllianceDetailsModal">showAllianceDetailsModal</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.switchTab">switchTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#.updateCoopTabBadge">updateCoopTabBadge</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~acceptUserToAlliance">acceptUserToAlliance</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~appendSearchResults">appendSearchResults</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~attachAllianceClickHandlers">attachAllianceClickHandlers</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~attachApplicationButtonListeners">attachApplicationButtonListeners</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~attachSearchEventListeners">attachSearchEventListeners</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~createAllianceRow">createAllianceRow</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~declineUserFromAlliance">declineUserFromAlliance</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~fetchAllianceInfo">fetchAllianceInfo</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~fetchAllianceInfoById">fetchAllianceInfoById</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~fetchAllianceMembers">fetchAllianceMembers</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~fetchAllianceMembersById">fetchAllianceMembersById</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~fetchAllianceSettings">fetchAllianceSettings</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~fetchHighScores">fetchHighScores</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~fetchLeagueInfo">fetchLeagueInfo</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~fetchQueuePool">fetchQueuePool</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~generateAllianceInfoHTML">generateAllianceInfoHTML</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~handleJoinAllianceClick">handleJoinAllianceClick</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~leaveAlliance">leaveAlliance</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~loadTabContent">loadTabContent</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~loadWelcomeMessage">loadWelcomeMessage</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~normalizeColor">normalizeColor</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~performSearch">performSearch</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~refreshApplicationsQueue">refreshApplicationsQueue</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~renderAllianzTab">renderAllianzTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~renderCoopTab">renderCoopTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~renderHighScoreTab">renderHighScoreTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~renderLigaTab">renderLigaTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~renderManagementTab">renderManagementTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~renderMemberCard">renderMemberCard</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~renderSearchResults">renderSearchResults</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~renderSearchTab">renderSearchTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~renderSettingsTab">renderSettingsTab</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~saveWelcomeMessage">saveWelcomeMessage</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~sendWelcomeMessageToUser">sendWelcomeMessageToUser</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~showDonateDialog">showDonateDialog</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~showTextInputDialog">showTextInputDialog</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~updateAllianceSettings">updateAllianceSettings</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~updateManagementTabVisibility">updateManagementTabVisibility</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~updateTabVisibilityForAllianceMembers">updateTabVisibilityForAllianceMembers</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~updateTabVisibilityForNonMembers">updateTabVisibilityForNonMembers</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~updateUserRole">updateUserRole</a></li><li data-type='method' style='display: none;'><a href="module-alliance-tabs.html#~updateWelcomeMessageCharCount">updateWelcomeMessageCharCount</a></li></ul></li><li><a href="module-analytics.html">analytics</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-analytics.html#.initAnalytics">initAnalytics</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~addApiStatsTab">addApiStatsTab</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~buildPod2Html">buildPod2Html</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~checkAndBuildIndex">checkAndBuildIndex</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~closeSoldVesselPanel">closeSoldVesselPanel</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~destroyChart">destroyChart</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~exportAnalyticsData">exportAnalyticsData</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~formatChartPrice">formatChartPrice</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~formatCurrency">formatCurrency</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~formatPercent">formatPercent</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~handleRawTransactionSort">handleRawTransactionSort</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~handleRouteClick">handleRouteClick</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~handleSort">handleSort</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~handleVesselClick">handleVesselClick</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~initSortableHeaders">initSortableHeaders</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~isCacheValid">isCacheValid</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~lazyLoadRoutes">lazyLoadRoutes</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~lazyLoadVessels">lazyLoadVessels</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~loadAnalyticsData">loadAnalyticsData</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~loadApiStats">loadApiStats</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~loadGameLogData">loadGameLogData</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~loadMoreRawTransactions">loadMoreRawTransactions</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~loadRawTransactions">loadRawTransactions</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~populateTypeFilter">populateTypeFilter</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~preloadAllTabs">preloadAllTabs</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderApiStatsChart">renderApiStatsChart</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderApiStatsSummary">renderApiStatsSummary</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderApiStatsTable">renderApiStatsTable</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderBottomVesselsRevenueChart">renderBottomVesselsRevenueChart</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderExpenseTable">renderExpenseTable</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderGameLogChart">renderGameLogChart</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderGameLogDailyTable">renderGameLogDailyTable</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderGameLogInfo">renderGameLogInfo</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderGameLogTable">renderGameLogTable</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderQuickSummary">renderQuickSummary</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderRawTransactionsTable">renderRawTransactionsTable</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderRouteTable">renderRouteTable</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderSoldVesselHistory">renderSoldVesselHistory</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderSummary">renderSummary</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderTop10Routes">renderTop10Routes</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderTrendChart">renderTrendChart</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderVesselCharts">renderVesselCharts</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderVesselTable">renderVesselTable</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderVesselsCompositionChart">renderVesselsCompositionChart</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderVesselsRevenueChart">renderVesselsRevenueChart</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~renderVesselsUtilizationChart">renderVesselsUtilizationChart</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~setupApiStatsControls">setupApiStatsControls</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~setupRawTransactionsLazyLoading">setupRawTransactionsLazyLoading</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~showLookupEntryDetails">showLookupEntryDetails</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~showRouteVesselsInfoTooltip">showRouteVesselsInfoTooltip</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~showSoldVesselPanel">showSoldVesselPanel</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~sortData">sortData</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~switchTab">switchTab</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~updateFilterName">updateFilterName</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~updateLoadMoreButton">updateLoadMoreButton</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~updateRawSortIndicators">updateRawSortIndicators</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~updateRawTransactionCounts">updateRawTransactionCounts</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~updateRouteFilterIcons">updateRouteFilterIcons</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~updateSortIndicators">updateSortIndicators</a></li><li data-type='method' style='display: none;'><a href="module-analytics.html#~updateVesselFilterIcons">updateVesselFilterIcons</a></li></ul></li><li><a href="module-api.html">api</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-api.html#.activateCampaign">activateCampaign</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.buildLookup">buildLookup</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.checkCompanyAge">checkCompanyAge</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.checkDevelMode">checkDevelMode</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.clearLookup">clearLookup</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.deleteAllLogs">deleteAllLogs</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.deleteChat">deleteChat</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.departAllVessels">departAllVessels</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.departVessel">departVessel</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.departVessels">departVessels</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.doWearMaintenanceBulk">doWearMaintenanceBulk</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.downloadLogbookExport">downloadLogbookExport</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchAcquirableVessels">fetchAcquirableVessels</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchAllianceMembers">fetchAllianceMembers</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchAssignedPorts">fetchAssignedPorts</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchBunkerPrices">fetchBunkerPrices</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchCampaigns">fetchCampaigns</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchChat">fetchChat</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchContacts">fetchContacts</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchLogbookEntries">fetchLogbookEntries</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchLogbookFileSize">fetchLogbookFileSize</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchMessengerChats">fetchMessengerChats</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchMessengerMessages">fetchMessengerMessages</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchUserCompany">fetchUserCompany</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchUserSettings">fetchUserSettings</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.fetchVessels">fetchVessels</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getAnalyticsAll">getAnalyticsAll</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getAnalyticsOverview">getAnalyticsOverview</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getAnalyticsRoutes">getAnalyticsRoutes</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getAnalyticsSummary">getAnalyticsSummary</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getAnalyticsTrend">getAnalyticsTrend</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getAnalyticsVessels">getAnalyticsVessels</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getApiStats">getApiStats</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getApiStatsDates">getApiStatsDates</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getApiStatsHourly">getApiStatsHourly</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getCompanyNameCached">getCompanyNameCached</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getLookupBreakdown">getLookupBreakdown</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getLookupDaily">getLookupDaily</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getLookupDetails">getLookupDetails</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getLookupEntries">getLookupEntries</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getLookupInfo">getLookupInfo</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getLookupTotals">getLookupTotals</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getMaintenanceCost">getMaintenanceCost</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getRecentIpos">getRecentIpos</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getRouteVessels">getRouteVessels</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getStockFinanceOverview">getStockFinanceOverview</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getStockMarket">getStockMarket</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getStockPurchaseTimes">getStockPurchaseTimes</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getTransactionDaily">getTransactionDaily</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getTransactionData">getTransactionData</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getTransactionInfo">getTransactionInfo</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getTransactionList">getTransactionList</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getTransactionSummary">getTransactionSummary</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.getTransactionTypes">getTransactionTypes</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.increaseStockForSale">increaseStockForSale</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.markChatAsRead">markChatAsRead</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.purchaseCO2">purchaseCO2</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.purchaseFuel">purchaseFuel</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.purchaseStock">purchaseStock</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.purchaseVessel">purchaseVessel</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.rebuildLookup">rebuildLookup</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.searchUsers">searchUsers</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.sellStock">sellStock</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.sendChatMessage">sendChatMessage</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.sendPrivateMessage">sendPrivateMessage</a></li><li data-type='method' style='display: none;'><a href="module-api.html#.syncTransactions">syncTransactions</a></li><li data-type='method' style='display: none;'><a href="module-api.html#~verifyVesselPurchased">verifyVesselPurchased</a></li></ul></li><li><a href="module-app.html">app</a></li><li><a href="module-automation.html">automation</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-automation.html#.initAutomation">initAutomation</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#.runAutomationChecks">runAutomationChecks</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#.triggerAutoRebuyChecks">triggerAutoRebuyChecks</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#~calculateRemainingDemand">calculateRemainingDemand</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#~checkAutoCampaignRenewal">checkAutoCampaignRenewal</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#~checkAutoDepartAll">checkAutoDepartAll</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#~checkAutoRebuyCO2">checkAutoRebuyCO2</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#~checkAutoRebuyFuel">checkAutoRebuyFuel</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#~getTotalCapacity">getTotalCapacity</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#~performAutoRebuyCO2">performAutoRebuyCO2</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#~performAutoRebuyFuel">performAutoRebuyFuel</a></li><li data-type='method' style='display: none;'><a href="module-automation.html#~updateAutoDepartLabel">updateAutoDepartLabel</a></li></ul></li><li><a href="module-badge-manager.html">badge-manager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-badge-manager.html#.getBadgeCount">getBadgeCount</a></li><li data-type='method' style='display: none;'><a href="module-badge-manager.html#.hideBadge">hideBadge</a></li><li data-type='method' style='display: none;'><a href="module-badge-manager.html#.showBadge">showBadge</a></li><li data-type='method' style='display: none;'><a href="module-badge-manager.html#.updateBadge">updateBadge</a></li><li data-type='method' style='display: none;'><a href="module-badge-manager.html#.updateButtonState">updateButtonState</a></li><li data-type='method' style='display: none;'><a href="module-badge-manager.html#.updateButtonTooltip">updateButtonTooltip</a></li><li data-type='method' style='display: none;'><a href="module-badge-manager.html#.updateButtonVisibility">updateButtonVisibility</a></li></ul></li><li><a href="module-broadcast.html">broadcast</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-broadcast.html#.initBroadcast">initBroadcast</a></li><li data-type='method' style='display: none;'><a href="module-broadcast.html#.initBroadcastForManagement">initBroadcastForManagement</a></li><li data-type='method' style='display: none;'><a href="module-broadcast.html#~deleteTemplate">deleteTemplate</a></li><li data-type='method' style='display: none;'><a href="module-broadcast.html#~editTemplate">editTemplate</a></li><li data-type='method' style='display: none;'><a href="module-broadcast.html#~loadTemplates">loadTemplates</a></li><li data-type='method' style='display: none;'><a href="module-broadcast.html#~renderTemplateList">renderTemplateList</a></li><li data-type='method' style='display: none;'><a href="module-broadcast.html#~saveTemplate">saveTemplate</a></li><li data-type='method' style='display: none;'><a href="module-broadcast.html#~toggleTemplate">toggleTemplate</a></li><li data-type='method' style='display: none;'><a href="module-broadcast.html#~updateMessageCounter">updateMessageCounter</a></li></ul></li><li><a href="module-bunker-management.html">bunker-management</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-bunker-management.html#.buyMaxCO2">buyMaxCO2</a></li><li data-type='method' style='display: none;'><a href="module-bunker-management.html#.buyMaxFuel">buyMaxFuel</a></li><li data-type='method' style='display: none;'><a href="module-bunker-management.html#.getCurrentBunkerState">getCurrentBunkerState</a></li><li data-type='method' style='display: none;'><a href="module-bunker-management.html#.setCapacityFromBunkerUpdate">setCapacityFromBunkerUpdate</a></li><li data-type='method' style='display: none;'><a href="module-bunker-management.html#.updateBunkerStatus">updateBunkerStatus</a></li><li data-type='method' style='display: none;'><a href="module-bunker-management.html#.updateCurrentCO2">updateCurrentCO2</a></li><li data-type='method' style='display: none;'><a href="module-bunker-management.html#.updateCurrentCash">updateCurrentCash</a></li><li data-type='method' style='display: none;'><a href="module-bunker-management.html#.updateCurrentFuel">updateCurrentFuel</a></li></ul></li><li><a href="module-chat.html">chat</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-chat.html#.displayMessages">displayMessages</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#.handleMessageInput">handleMessageInput</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#.initWebSocket">initWebSocket</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#.loadAllianceMembers">loadAllianceMembers</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#.loadMessages">loadMessages</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#.markAllianceChatAsRead">markAllianceChatAsRead</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#.parseMessageWithMentions">parseMessageWithMentions</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#.sendMessage">sendMessage</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#.setChatScrollListener">setChatScrollListener</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~attemptReconnect">attemptReconnect</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~displaySuggestions">displaySuggestions</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~formatLocalTime">formatLocalTime</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleAllianceChanged">handleAllianceChanged</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleAllianceIndexReady">handleAllianceIndexReady</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleAutoCoopComplete">handleAutoCoopComplete</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleAutoCoopNoTargets">handleAutoCoopNoTargets</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleAutopilotDepartStart">handleAutopilotDepartStart</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleBackendAutoRepairComplete">handleBackendAutoRepairComplete</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleBunkerUpdate">handleBunkerUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleCO2Purchased">handleCO2Purchased</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleCampaignsRenewed">handleCampaignsRenewed</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleCompanyTypeUpdate">handleCompanyTypeUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleCoopUpdate">handleCoopUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleDrydockCountUpdate">handleDrydockCountUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleFuelPurchased">handleFuelPurchased</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleGenericNotification">handleGenericNotification</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleHarborMapRefreshRequired">handleHarborMapRefreshRequired</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleHeaderDataUpdate">handleHeaderDataUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleHijackingUpdate">handleHijackingUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleIpoAlertUpdate">handleIpoAlertUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleMentionAutocomplete">handleMentionAutocomplete</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleMessengerUpdate">handleMessengerUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handlePriceAlert">handlePriceAlert</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handlePriceUpdate">handlePriceUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handlePurserPurchase">handlePurserPurchase</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handlePurserSell">handlePurserSell</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleRepairCountUpdate">handleRepairCountUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleStaffTrainingPointsUpdate">handleStaffTrainingPointsUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleStaffUpdate">handleStaffUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleUnreadMessagesUpdate">handleUnreadMessagesUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleUserActionNotification">handleUserActionNotification</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleVesselCountUpdate">handleVesselCountUpdate</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleVesselsDepartBatch">handleVesselsDepartBatch</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleVesselsDepartComplete">handleVesselsDepartComplete</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleVesselsDeparted">handleVesselsDeparted</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleVesselsDrydocked">handleVesselsDrydocked</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleVesselsFailed">handleVesselsFailed</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~handleVesselsRepaired">handleVesselsRepaired</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~hideMemberSuggestions">hideMemberSuggestions</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~insertMention">insertMention</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~registerUsernameClickEvents">registerUsernameClickEvents</a></li><li data-type='method' style='display: none;'><a href="module-chat.html#~updateAllianceChatBadge">updateAllianceChatBadge</a></li></ul></li><li><a href="module-company-profile.html">company-profile</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-company-profile.html#.closeCompanyProfile">closeCompanyProfile</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#.initCompanyProfile">initCompanyProfile</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#.openCompanyProfile">openCompanyProfile</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#.openPlayerProfile">openPlayerProfile</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~addToContacts">addToContacts</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~adjustSalary">adjustSalary</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~attachAllianceClickListener">attachAllianceClickListener</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~attachSalaryButtonListeners">attachSalaryButtonListeners</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~attachStockActionListeners">attachStockActionListeners</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~buildAchievementsSection">buildAchievementsSection</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~buildSection">buildSection</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~buildStaffSection">buildStaffSection</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~dismissStaffPointsBanner">dismissStaffPointsBanner</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~formatLabel">formatLabel</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~formatMoraleLabel">formatMoraleLabel</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~formatPerkName">formatPerkName</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~formatValue">formatValue</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~generateMoraleSmiley">generateMoraleSmiley</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~loadAllianceDetails">loadAllianceDetails</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~loadCompanyProfile">loadCompanyProfile</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~loadStaffData">loadStaffData</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~loadStockSection">loadStockSection</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~normalizeColor">normalizeColor</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~removeFromContacts">removeFromContacts</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~renderCompanyProfile">renderCompanyProfile</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~renderSearchResults">renderSearchResults</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~searchPlayers">searchPlayers</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~startStockSellTimer">startStockSellTimer</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~toggleAchievementsList">toggleAchievementsList</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~toggleStaffDetails">toggleStaffDetails</a></li><li data-type='method' style='display: none;'><a href="module-company-profile.html#~trainPerk">trainPerk</a></li></ul></li><li><a href="module-coop.html">coop</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-coop.html#.closeCoopOverlay">closeCoopOverlay</a></li><li data-type='method' style='display: none;'><a href="module-coop.html#.fetchCoopData">fetchCoopData</a></li><li data-type='method' style='display: none;'><a href="module-coop.html#.sendCoopMax">sendCoopMax</a></li><li data-type='method' style='display: none;'><a href="module-coop.html#.showCoopOverlay">showCoopOverlay</a></li><li data-type='method' style='display: none;'><a href="module-coop.html#.updateCoopBadge">updateCoopBadge</a></li><li data-type='method' style='display: none;'><a href="module-coop.html#~renderMemberCard">renderMemberCard</a></li></ul></li><li><a href="module-core_app-initializer.html">core/app-initializer</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#.initializeApp">initializeApp</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~createAllianceChatHandler">createAllianceChatHandler</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~createBuyVesselsHandler">createBuyVesselsHandler</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~createDebouncedFunctions">createDebouncedFunctions</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~createForecastHandler">createForecastHandler</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~createTestBrowserNotification">createTestBrowserNotification</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~exposeGlobalFunctions">exposeGlobalFunctions</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~formatNumberWithSeparator">formatNumberWithSeparator</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~initializeSettingsUI">initializeSettingsUI</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~loadInitialData">loadInitialData</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~loadUserSettings">loadUserSettings</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~registerAllEventListeners">registerAllEventListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~setCheckboxState">setCheckboxState</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~setCheckboxValue">setCheckboxValue</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~setFormattedInputValue">setFormattedInputValue</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~setInputValue">setInputValue</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~setSelectValue">setSelectValue</a></li><li data-type='method' style='display: none;'><a href="module-core_app-initializer.html#~toggleElementVisibility">toggleElementVisibility</a></li></ul></li><li><a href="module-core_auto-refresh.html">core/auto-refresh</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_auto-refresh.html#.getActiveIntervals">getActiveIntervals</a></li><li data-type='method' style='display: none;'><a href="module-core_auto-refresh.html#.initNotificationButtonUpdater">initNotificationButtonUpdater</a></li><li data-type='method' style='display: none;'><a href="module-core_auto-refresh.html#.initVersionChecker">initVersionChecker</a></li><li data-type='method' style='display: none;'><a href="module-core_auto-refresh.html#.initVisibilityHandler">initVisibilityHandler</a></li><li data-type='method' style='display: none;'><a href="module-core_auto-refresh.html#.preloadAllImages">preloadAllImages</a></li><li data-type='method' style='display: none;'><a href="module-core_auto-refresh.html#.stopAllIntervals">stopAllIntervals</a></li><li data-type='method' style='display: none;'><a href="module-core_auto-refresh.html#.stopInterval">stopInterval</a></li></ul></li><li><a href="module-core_badge-cache.html">core/badge-cache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#.loadCache">loadCache</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#.saveBadgeCache">saveBadgeCache</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#.updateCoopDisplay">updateCoopDisplay</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#~loadBunkerStatus">loadBunkerStatus</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#~loadCampaignsBadge">loadCampaignsBadge</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#~loadCoopData">loadCoopData</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#~loadHijackingBadge">loadHijackingBadge</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#~loadPrices">loadPrices</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#~loadRepairBadges">loadRepairBadges</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#~loadStockAndAnchor">loadStockAndAnchor</a></li><li data-type='method' style='display: none;'><a href="module-core_badge-cache.html#~loadVesselBadges">loadVesselBadges</a></li></ul></li><li><a href="module-core_debounced-api.html">core/debounced-api</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_debounced-api.html#.cancelAllDebouncedFunctions">cancelAllDebouncedFunctions</a></li><li data-type='method' style='display: none;'><a href="module-core_debounced-api.html#.cancelDebouncedFunction">cancelDebouncedFunction</a></li><li data-type='method' style='display: none;'><a href="module-core_debounced-api.html#.createDebouncedFunction">createDebouncedFunction</a></li><li data-type='method' style='display: none;'><a href="module-core_debounced-api.html#.isDebouncePending">isDebouncePending</a></li></ul></li><li><a href="module-core_event-registry.html">core/event-registry</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerAutoDepartSettingsListeners">registerAutoDepartSettingsListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerAutoPilotFeatureListeners">registerAutoPilotFeatureListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerAutoPilotListeners">registerAutoPilotListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerAutoRebuyCO2Listeners">registerAutoRebuyCO2Listeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerAutoRebuyFuelListeners">registerAutoRebuyFuelListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerBunkerListeners">registerBunkerListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerChatBotSettingsListeners">registerChatBotSettingsListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerChatEventListeners">registerChatEventListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerCustomCommandsListeners">registerCustomCommandsListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerDialogEventListeners">registerDialogEventListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerMessengerEventListeners">registerMessengerEventListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerNotificationPermissionListener">registerNotificationPermissionListener</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerNumberFormatting">registerNumberFormatting</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerSectionToggle">registerSectionToggle</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerSettingsThresholdListeners">registerSettingsThresholdListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#.registerVesselCatalogEventListeners">registerVesselCatalogEventListeners</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#~createCustomCommandElement">createCustomCommandElement</a></li><li data-type='method' style='display: none;'><a href="module-core_event-registry.html#~formatNumberWithSeparator">formatNumberWithSeparator</a></li></ul></li><li><a href="module-core_global-exports.html">core/global-exports</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportApiUrl">exportApiUrl</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportAutopilotFunctions">exportAutopilotFunctions</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportCacheKeys">exportCacheKeys</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportDebouncedFunctions">exportDebouncedFunctions</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportDebugMode">exportDebugMode</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportGlobals">exportGlobals</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportLogbookHandler">exportLogbookHandler</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportOverlayFunctions">exportOverlayFunctions</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportSettingsHandler">exportSettingsHandler</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportStorageFunctions">exportStorageFunctions</a></li><li data-type='method' style='display: none;'><a href="module-core_global-exports.html#.exportVersionFunctions">exportVersionFunctions</a></li></ul></li><li><a href="module-core_settings-sync.html">core/settings-sync</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_settings-sync.html#.handleSettingsUpdate">handleSettingsUpdate</a></li><li data-type='method' style='display: none;'><a href="module-core_settings-sync.html#.toggleAutoPilotAgentCheckboxes">toggleAutoPilotAgentCheckboxes</a></li><li data-type='method' style='display: none;'><a href="module-core_settings-sync.html#~formatNumberWithSeparator">formatNumberWithSeparator</a></li><li data-type='method' style='display: none;'><a href="module-core_settings-sync.html#~updateAutoPilotToggles">updateAutoPilotToggles</a></li><li data-type='method' style='display: none;'><a href="module-core_settings-sync.html#~updateAutoRebuyCO2UI">updateAutoRebuyCO2UI</a></li><li data-type='method' style='display: none;'><a href="module-core_settings-sync.html#~updateAutoRebuyFuelUI">updateAutoRebuyFuelUI</a></li><li data-type='method' style='display: none;'><a href="module-core_settings-sync.html#~updateChatBotSettings">updateChatBotSettings</a></li><li data-type='method' style='display: none;'><a href="module-core_settings-sync.html#~updateNotificationSettings">updateNotificationSettings</a></li><li data-type='method' style='display: none;'><a href="module-core_settings-sync.html#~updateThresholdInputs">updateThresholdInputs</a></li></ul></li><li><a href="module-core_storage-manager.html">core/storage-manager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_storage-manager.html#.clearUserStorage">clearUserStorage</a></li><li data-type='method' style='display: none;'><a href="module-core_storage-manager.html#.getStorage">getStorage</a></li><li data-type='method' style='display: none;'><a href="module-core_storage-manager.html#.getUserStorageKey">getUserStorageKey</a></li><li data-type='method' style='display: none;'><a href="module-core_storage-manager.html#.getUserStoragePrefix">getUserStoragePrefix</a></li><li data-type='method' style='display: none;'><a href="module-core_storage-manager.html#.removeStorage">removeStorage</a></li><li data-type='method' style='display: none;'><a href="module-core_storage-manager.html#.setStorage">setStorage</a></li><li data-type='method' style='display: none;'><a href="module-core_storage-manager.html#.setUserStoragePrefix">setUserStoragePrefix</a></li></ul></li><li><a href="module-core_websocket-client.html">core/websocket-client</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-core_websocket-client.html#.getWebSocketState">getWebSocketState</a></li><li data-type='method' style='display: none;'><a href="module-core_websocket-client.html#.incrementReconnectCounter">incrementReconnectCounter</a></li><li data-type='method' style='display: none;'><a href="module-core_websocket-client.html#.initAutopilotControls">initAutopilotControls</a></li><li data-type='method' style='display: none;'><a href="module-core_websocket-client.html#.loadAutopilotState">loadAutopilotState</a></li><li data-type='method' style='display: none;'><a href="module-core_websocket-client.html#.resetReconnectCounter">resetReconnectCounter</a></li><li data-type='method' style='display: none;'><a href="module-core_websocket-client.html#.triggerPriceAlertCheck">triggerPriceAlertCheck</a></li><li data-type='method' style='display: none;'><a href="module-core_websocket-client.html#.updateWebSocketState">updateWebSocketState</a></li></ul></li><li><a href="module-depart-manager.html">depart-manager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-depart-manager.html#.closeDepartManager">closeDepartManager</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#.initializeDepartManager">initializeDepartManager</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#.openDepartManager">openDepartManager</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#.refreshDepartManagerIfOpen">refreshDepartManagerIfOpen</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#.toggleDepartManager">toggleDepartManager</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#.updateDepartManagerLockState">updateDepartManagerLockState</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~addMassMoorEventHandlers">addMassMoorEventHandlers</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~addVesselItemEventHandlers">addVesselItemEventHandlers</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~clearSearch">clearSearch</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~departSelectedVessels">departSelectedVessels</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~drag">drag</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~formatDuration">formatDuration</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~formatETA">formatETA</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~formatLoadingStatus">formatLoadingStatus</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~getLoadingStatus">getLoadingStatus</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~getPortDrydock">getPortDrydock</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~getStatusInfo">getStatusInfo</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~getVesselStatusText">getVesselStatusText</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~loadPortsData">loadPortsData</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~loadVesselsByStatus">loadVesselsByStatus</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~locateVesselOnMap">locateVesselOnMap</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~moorSelectedVessels">moorSelectedVessels</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~renderDrydockEnrouteItem">renderDrydockEnrouteItem</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~renderDrydockTab">renderDrydockTab</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~renderMassMoorTab">renderMassMoorTab</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~renderMassMoorVesselItem">renderMassMoorVesselItem</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~renderVesselItem">renderVesselItem</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~resumeSelectedVessels">resumeSelectedVessels</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~searchVesselsAcrossTabs">searchVesselsAcrossTabs</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~selectAllVessels">selectAllVessels</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~selectVesselRouteOnMap">selectVesselRouteOnMap</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~startDrag">startDrag</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~stopDrag">stopDrag</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~unselectAllVessels">unselectAllVessels</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updateAnchorTabCount">updateAnchorTabCount</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updateAtPortTabCount">updateAtPortTabCount</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updateAtSeaTabCount">updateAtSeaTabCount</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updateDepartButtonCount">updateDepartButtonCount</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updateDryDockTabCount">updateDryDockTabCount</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updateMassMoorButtonCounts">updateMassMoorButtonCounts</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updateMoorResumeButtonCounts">updateMoorResumeButtonCounts</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updateMoorTabCount">updateMoorTabCount</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updatePendingTabCount">updatePendingTabCount</a></li><li data-type='method' style='display: none;'><a href="module-depart-manager.html#~updateVesselMoorState">updateVesselMoorState</a></li></ul></li><li><a href="module-desktop-notification-templates.html">desktop-notification-templates</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-desktop-notification-templates.html#.createDesktopNotification">createDesktopNotification</a></li><li data-type='method' style='display: none;'><a href="module-desktop-notification-templates.html#.getDefaultEmoji">getDefaultEmoji</a></li><li data-type='method' style='display: none;'><a href="module-desktop-notification-templates.html#.getNotificationTypes">getNotificationTypes</a></li><li data-type='method' style='display: none;'><a href="module-desktop-notification-templates.html#.isValidNotificationType">isValidNotificationType</a></li><li data-type='method' style='display: none;'><a href="module-desktop-notification-templates.html#.notifyAlert">notifyAlert</a></li><li data-type='method' style='display: none;'><a href="module-desktop-notification-templates.html#.notifyError">notifyError</a></li><li data-type='method' style='display: none;'><a href="module-desktop-notification-templates.html#.notifySuccess">notifySuccess</a></li><li data-type='method' style='display: none;'><a href="module-desktop-notification-templates.html#.notifyWarning">notifyWarning</a></li></ul></li><li><a href="module-event-info.html">event-info</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-event-info.html#.initEventInfo">initEventInfo</a></li><li data-type='method' style='display: none;'><a href="module-event-info.html#.openEventModal">openEventModal</a></li><li data-type='method' style='display: none;'><a href="module-event-info.html#.updateEventData">updateEventData</a></li><li data-type='method' style='display: none;'><a href="module-event-info.html#~startEventTimer">startEventTimer</a></li></ul></li><li><a href="module-forecast-calendar.html">forecast-calendar</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#.initForecastCalendar">initForecastCalendar</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#.updateEventDiscount">updateEventDiscount</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~createTableHTML">createTableHTML</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~getBrowserTimezone">getBrowserTimezone</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~getCo2Class">getCo2Class</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~getCurrentVisibleDay">getCurrentVisibleDay</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~getFuelClass">getFuelClass</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~isEventActiveAtTime">isEventActiveAtTime</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~isEventActiveOnDay">isEventActiveOnDay</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~loadForecastData">loadForecastData</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~preloadMonth">preloadMonth</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~renderBook">renderBook</a></li><li data-type='method' style='display: none;'><a href="module-forecast-calendar.html#~updateEventBadge">updateEventBadge</a></li></ul></li><li><a href="module-harbor-map-aggregator.html">harbor-map-aggregator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map-aggregator.html#~aggregateReachablePorts">aggregateReachablePorts</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-aggregator.html#~aggregateVesselData">aggregateVesselData</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-aggregator.html#~categorizeVesselsByPort">categorizeVesselsByPort</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-aggregator.html#~extractPortsFromGameIndex">extractPortsFromGameIndex</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-aggregator.html#~extractVesselsFromGameIndex">extractVesselsFromGameIndex</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-aggregator.html#~filterAssignedPorts">filterAssignedPorts</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-aggregator.html#~formatPortAbbreviation">formatPortAbbreviation</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-aggregator.html#~groupVesselsByPortPair">groupVesselsByPortPair</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-aggregator.html#~hasOwnImage">hasOwnImage</a></li></ul></li><li><a href="module-harbor-map-calculator.html">harbor-map-calculator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map-calculator.html#~calculateCargoUtilization">calculateCargoUtilization</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-calculator.html#~calculateDemandLevel">calculateDemandLevel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-calculator.html#~calculateETA">calculateETA</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-calculator.html#~calculateVesselPosition">calculateVesselPosition</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-calculator.html#~formatCargoCapacity">formatCargoCapacity</a></li></ul></li><li><a href="module-harbor-map-init.html">harbor-map-init</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#.closeHarborMap">closeHarborMap</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#.forceRefreshMap">forceRefreshMap</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#.initHarborMap">initHarborMap</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#.openHarborMap">openHarborMap</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#.preloadHarborMapData">preloadHarborMapData</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#.refreshHarborMapIfOpen">refreshHarborMapIfOpen</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#.reloadMap">reloadMap</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#.startHarborMapAutoUpdate">startHarborMapAutoUpdate</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#.stopHarborMapAutoUpdate">stopHarborMapAutoUpdate</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#~departVesselWrapper">departVesselWrapper</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#~getVesselByIdWrapper">getVesselByIdWrapper</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#~selectVesselFromMap">selectVesselFromMap</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#~sellVesselFromPanelWrapper">sellVesselFromPanelWrapper</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map-init.html#~updateVesselMarkerWrapper">updateVesselMarkerWrapper</a></li></ul></li><li><a href="module-harbor-map_api-client.html">harbor-map/api-client</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.clearHarborMapCache">clearHarborMapCache</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.clearOverviewCache">clearOverviewCache</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.exportVesselHistory">exportVesselHistory</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.fetchHarborMapOverview">fetchHarborMapOverview</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.fetchPortDetails">fetchPortDetails</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.fetchVesselHistory">fetchVesselHistory</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.fetchVesselReachablePorts">fetchVesselReachablePorts</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.getCachedOverview">getCachedOverview</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.invalidateOverviewCache">invalidateOverviewCache</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_api-client.html#.prefetchHarborMapData">prefetchHarborMapData</a></li></ul></li><li><a href="module-harbor-map_filters.html">harbor-map/filters</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.applyDemandFilter">applyDemandFilter</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.calculatePortCurrentCargoDemand">calculatePortCurrentCargoDemand</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.calculatePortCurrentOilDemand">calculatePortCurrentOilDemand</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.calculatePortMaxCargoDemand">calculatePortMaxCargoDemand</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.calculatePortMaxOilDemand">calculatePortMaxOilDemand</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.filterPorts">filterPorts</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.filterPortsByPortPair">filterPortsByPortPair</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.filterVessels">filterVessels</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.filterVesselsByPortPair">filterVesselsByPortPair</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.getDemandFilterOptions">getDemandFilterOptions</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.getPortFilterOptions">getPortFilterOptions</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#.getVesselFilterOptions">getVesselFilterOptions</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_filters.html#~calculateVesselUtilization">calculateVesselUtilization</a></li></ul></li><li><a href="module-harbor-map_map-controller.html">harbor-map/map-controller</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.clearRoute">clearRoute</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.closeAllPanels">closeAllPanels</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.deselectAll">deselectAll</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.drawRoute">drawRoute</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.getCurrentPorts">getCurrentPorts</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.getMap">getMap</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.getSelectedPortCode">getSelectedPortCode</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.getVesselById">getVesselById</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.highlightPorts">highlightPorts</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.initMap">initMap</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.loadOverview">loadOverview</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.renderPorts">renderPorts</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.renderVessels">renderVessels</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.resetPortDisplay">resetPortDisplay</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.selectPort">selectPort</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.selectVessel">selectVessel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.setPortFilter">setPortFilter</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.setRouteFilter">setRouteFilter</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.setVesselFilter">setVesselFilter</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.updateVesselMarker">updateVesselMarker</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#.updateWeatherDataSetting">updateWeatherDataSetting</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~addCustomControls">addCustomControls</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~applyFilterModalSelections">applyFilterModalSelections</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~applyFiltersAndRender">applyFiltersAndRender</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~applyMapTheme">applyMapTheme</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~calculateHeading">calculateHeading</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~categorizeVesselsByPortClientSide">categorizeVesselsByPortClientSide</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~changeTileLayer">changeTileLayer</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~closeFilterModal">closeFilterModal</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~createVesselIcon">createVesselIcon</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~getVesselType">getVesselType</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~hideRouteVesselsPanel">hideRouteVesselsPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~initFilterModalDrag">initFilterModalDrag</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~onFilterModalDrag">onFilterModalDrag</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~onFilterModalDragEnd">onFilterModalDragEnd</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~openFilterModal">openFilterModal</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~populateFilterModalDropdowns">populateFilterModalDropdowns</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~resetAllFilters">resetAllFilters</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~showRouteVesselsPanel">showRouteVesselsPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~showWeatherInfo">showWeatherInfo</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~toggleWeatherLayer">toggleWeatherLayer</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~updateDemandFilterDropdowns">updateDemandFilterDropdowns</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_map-controller.html#~updateRouteDropdown">updateRouteDropdown</a></li></ul></li><li><a href="module-harbor-map_panel-drag.html">harbor-map/panel-drag</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map_panel-drag.html#.initializePanelDrag">initializePanelDrag</a></li></ul></li><li><a href="module-harbor-map_port-panel.html">harbor-map/port-panel</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#.closePortPanel">closePortPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#.fetchAndUpdatePortDemand">fetchAndUpdatePortDemand</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#.hidePortPanel">hidePortPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#.selectVesselFromPort">selectVesselFromPort</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#.showPortPanel">showPortPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#~loadPortAllianceData">loadPortAllianceData</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#~loadPortWeather">loadPortWeather</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#~openAllianceModal">openAllianceModal</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#~renderDemandSection">renderDemandSection</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#~renderTypicalDemandSection">renderTypicalDemandSection</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_port-panel.html#~renderVesselList">renderVesselList</a></li></ul></li><li><a href="module-harbor-map_route-vessels-panel.html">harbor-map/route-vessels-panel</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map_route-vessels-panel.html#.closeRoutePanel">closeRoutePanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_route-vessels-panel.html#.hideRoutePanel">hideRoutePanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_route-vessels-panel.html#.selectRouteVessel">selectRouteVessel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_route-vessels-panel.html#.showRoutePanel">showRoutePanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_route-vessels-panel.html#~storeVessels">storeVessels</a></li></ul></li><li><a href="module-harbor-map_vessel-panel.html">harbor-map/vessel-panel</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.closeVesselPanel">closeVesselPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.departVessel">departVessel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.exportHistoryFormat">exportHistoryFormat</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.getCurrentVesselId">getCurrentVesselId</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.hideVesselPanel">hideVesselPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.isLocalDepartInProgress">isLocalDepartInProgress</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.refreshOpenVesselPanel">refreshOpenVesselPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.sellVesselFromPanel">sellVesselFromPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.showVesselPanel">showVesselPanel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.startRenameVessel">startRenameVessel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.toggleExportMenu">toggleExportMenu</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#.updateVesselPanelDepartButtons">updateVesselPanelDepartButtons</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~cancelVesselRename">cancelVesselRename</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~closeExportMenuOnClickOutside">closeExportMenuOnClickOutside</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~formatLoadingStatusText">formatLoadingStatusText</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~formatTimeRemaining">formatTimeRemaining</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~formatVesselStatus">formatVesselStatus</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~getCountryFlag">getCountryFlag</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~getLoadingStatus">getLoadingStatus</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~getPortCountryCode">getPortCountryCode</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~loadRoutePortDemands">loadRoutePortDemands</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~loadVesselHistory">loadVesselHistory</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~loadVesselWeather">loadVesselWeather</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~openRepairDialog">openRepairDialog</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~openVesselAppearanceEditor">openVesselAppearanceEditor</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~processDepartureQueue">processDepartureQueue</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~renderHistoryPage">renderHistoryPage</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~saveVesselRename">saveVesselRename</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~setupInfiniteScroll">setupInfiniteScroll</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~toggleParkVessel">toggleParkVessel</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~updateVesselCardName">updateVesselCardName</a></li><li data-type='method' style='display: none;'><a href="module-harbor-map_vessel-panel.html#~updateVesselNameInShipsMenu">updateVesselNameInShipsMenu</a></li></ul></li><li><a href="module-logbook.html">logbook</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-logbook.html#.deleteAllLogsConfirmed">deleteAllLogsConfirmed</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#.getLogFileSize">getLogFileSize</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#.initLogbook">initLogbook</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#.prependLogEntry">prependLogEntry</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~applyFiltersToEntries">applyFiltersToEntries</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~convertActionFilterToBackend">convertActionFilterToBackend</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~createLogEntryHTML">createLogEntryHTML</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~ensureScrollable">ensureScrollable</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~exportLogs">exportLogs</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~formatDetails">formatDetails</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~formatTimestamp">formatTimestamp</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~getTransactionType">getTransactionType</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~loadLogs">loadLogs</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~renderLogPage">renderLogPage</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~renderLogTable">renderLogTable</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~setupEventListeners">setupEventListeners</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~updateActionFilter">updateActionFilter</a></li><li data-type='method' style='display: none;'><a href="module-logbook.html#~updateLogCount">updateLogCount</a></li></ul></li><li><a href="module-map-icon-bar.html">map-icon-bar</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-map-icon-bar.html#.closeAllModalOverlays">closeAllModalOverlays</a></li><li data-type='method' style='display: none;'><a href="module-map-icon-bar.html#.initializeMapIconBar">initializeMapIconBar</a></li><li data-type='method' style='display: none;'><a href="module-map-icon-bar.html#~handleIconAction">handleIconAction</a></li></ul></li><li><a href="module-messenger.html">messenger</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-messenger.html#.closeAllChats">closeAllChats</a></li><li data-type='method' style='display: none;'><a href="module-messenger.html#.closeChatSelection">closeChatSelection</a></li><li data-type='method' style='display: none;'><a href="module-messenger.html#.openMessenger">openMessenger</a></li><li data-type='method' style='display: none;'><a href="module-messenger.html#.openNewChat">openNewChat</a></li><li data-type='method' style='display: none;'><a href="module-messenger.html#.showAllChats">showAllChats</a></li><li data-type='method' style='display: none;'><a href="module-messenger.html#.updateUnreadBadge">updateUnreadBadge</a></li><li data-type='method' style='display: none;'><a href="module-messenger.html#~formatTimestamp">formatTimestamp</a></li><li data-type='method' style='display: none;'><a href="module-messenger.html#~loadPrivateMessages">loadPrivateMessages</a></li><li data-type='method' style='display: none;'><a href="module-messenger.html#~stopHijackingPolling">stopHijackingPolling</a></li></ul></li><li><a href="module-public_js_modules_hijacking.html">public/js/modules/hijacking</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#.closeHijackingInbox">closeHijackingInbox</a></li><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#.openHijackingInbox">openHijackingInbox</a></li><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#.updateHijackedVesselsDisplay">updateHijackedVesselsDisplay</a></li><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#.updateHijackingBadge">updateHijackingBadge</a></li><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#~deleteCase">deleteCase</a></li><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#~escapeHtml">escapeHtml</a></li><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#~formatTimestamp">formatTimestamp</a></li><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#~openCaseDetails">openCaseDetails</a></li><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#~refreshHijackingBadge">refreshHijackingBadge</a></li><li data-type='method' style='display: none;'><a href="module-public_js_modules_hijacking.html#~renderCaseList">renderCaseList</a></li></ul></li><li><a href="module-route-planner.html">route-planner</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-route-planner.html#.closeRoutePlanner">closeRoutePlanner</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#.getPlanningVesselId">getPlanningVesselId</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#.initializeRoutePlanner">initializeRoutePlanner</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#.isPlanningMode">isPlanningMode</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#.openRoutePlanner">openRoutePlanner</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#.restorePlanningState">restorePlanningState</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#.selectPortForRoute">selectPortForRoute</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~applyPortFilter">applyPortFilter</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~calculateFuelConsumption">calculateFuelConsumption</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~calculateGuardsCost">calculateGuardsCost</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~calculateHarborFeeRange">calculateHarborFeeRange</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~calculateRemainingDemand">calculateRemainingDemand</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~calculateRouteCreationFee">calculateRouteCreationFee</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~calculateTravelTime">calculateTravelTime</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~clearRouteSelection">clearRouteSelection</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~createRoute">createRoute</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~fetchAndDisplayDemand">fetchAndDisplayDemand</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~fetchRouteData">fetchRouteData</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~fetchRouteTabDemand">fetchRouteTabDemand</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~formatDemandCell">formatDemandCell</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~formatPortName">formatPortName</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~formatTravelTime">formatTravelTime</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~loadSuggestedRoute">loadSuggestedRoute</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~loadVesselPorts">loadVesselPorts</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~saveRouteChanges">saveRouteChanges</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~showError">showError</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~switchTab">switchTab</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~updateDemandDisplay">updateDemandDisplay</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~updatePortsGuardsDisplay">updatePortsGuardsDisplay</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~updatePortsSpeedDisplay">updatePortsSpeedDisplay</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~updateRouteTabDemandDisplay">updateRouteTabDemandDisplay</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~updateRouteTabVisibility">updateRouteTabVisibility</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~updateRouteTabWithCurrentRoute">updateRouteTabWithCurrentRoute</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~updateSelectedPortDisplay">updateSelectedPortDisplay</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~updateSliderDisplays">updateSliderDisplays</a></li><li data-type='method' style='display: none;'><a href="module-route-planner.html#~updateVesselCapacityDisplay">updateVesselCapacityDisplay</a></li></ul></li><li><a href="module-server_analytics_aggregator.html">server/analytics/aggregator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~aggregateRansomPayments">aggregateRansomPayments</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~calculateRouteHijackCounts">calculateRouteHijackCounts</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~calculateWeightedAverage">calculateWeightedAverage</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~fetchGameHijackingRisks">fetchGameHijackingRisks</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~filterByDays">filterByDays</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~filterByType">filterByType</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~formatRouteDisplay">formatRouteDisplay</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getActionTypes">getActionTypes</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getAuditLogPath">getAuditLogPath</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getContributionAnalysis">getContributionAnalysis</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getDailyRevenueTrend">getDailyRevenueTrend</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getDetailedExpenses">getDetailedExpenses</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getFilteredLogs">getFilteredLogs</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getHarborFeeAnalysis">getHarborFeeAnalysis</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getMergedDepartures">getMergedDepartures</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getMergedOperationsSummary">getMergedOperationsSummary</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getMergedSummary">getMergedSummary</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getPurchaseAnalysis">getPurchaseAnalysis</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getRouteContribution">getRouteContribution</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getRouteProfitability">getRouteProfitability</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getRouteProfitabilityMerged">getRouteProfitabilityMerged</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getRouteProfitabilityWithContribution">getRouteProfitabilityWithContribution</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getTripDataPath">getTripDataPath</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getVesselNameFromHijackHistory">getVesselNameFromHijackHistory</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getVesselPerformance">getVesselPerformance</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getVesselPerformanceMerged">getVesselPerformanceMerged</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getVesselPerformanceWithContribution">getVesselPerformanceWithContribution</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getVesselsByRoute">getVesselsByRoute</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~getWeeklySummary">getWeeklySummary</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~isAutopilotTransaction">isAutopilotTransaction</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~loadAuditLog">loadAuditLog</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~loadTripData">loadTripData</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~mapContextToAutopilotType">mapContextToAutopilotType</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~mapContextToCategory">mapContextToCategory</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_aggregator.html#~normalizeRouteKey">normalizeRouteKey</a></li></ul></li><li><a href="module-server_analytics_api-stats-store.html">server/analytics/api-stats-store</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~cleanupOldStats">cleanupOldStats</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~ensureDir">ensureDir</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~flushBuffer">flushBuffer</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~getAvailableDates">getAvailableDates</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~getCurrentMinuteKey">getCurrentMinuteKey</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~getHourlyStats">getHourlyStats</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~getStats">getStats</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~getStorePathForDate">getStorePathForDate</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~loadDayStats">loadDayStats</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~recordCall">recordCall</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~saveDayStats">saveDayStats</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~startAutoFlush">startAutoFlush</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_api-stats-store.html#~stopAutoFlush">stopAutoFlush</a></li></ul></li><li><a href="module-server_analytics_lookup-store.html">server/analytics/lookup-store</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~buildLookup">buildLookup</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~buildPod2Index">buildPod2Index</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~buildPod3Index">buildPod3Index</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~clearStore">clearStore</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~ensureDir">ensureDir</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~extractCashFromEntry">extractCashFromEntry</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~findPod2Match">findPod2Match</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~findPod2MatchForGuardFee">findPod2MatchForGuardFee</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~findPod2MatchForHarborFee">findPod2MatchForHarborFee</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~findPod2MatchForRouteFee">findPod2MatchForRouteFee</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~findPod3Match">findPod3Match</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~findPod3MatchByCalculation">findPod3MatchByCalculation</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~getBreakdownByDay">getBreakdownByDay</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~getBreakdownByType">getBreakdownByType</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~getEntries">getEntries</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~getEntriesByDays">getEntriesByDays</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~getEntryDetails">getEntryDetails</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~getStoreInfo">getStoreInfo</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~getStorePath">getStorePath</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~getTotals">getTotals</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~loadStore">loadStore</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~saveStore">saveStore</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_lookup-store.html#~valuesMatch">valuesMatch</a></li></ul></li><li><a href="module-server_analytics_transaction-store.html">server/analytics/transaction-store</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~ensureDir">ensureDir</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~fetchFromAPI">fetchFromAPI</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~generateTransactionId">generateTransactionId</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~getDailyBreakdown">getDailyBreakdown</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~getStoreInfo">getStoreInfo</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~getStorePath">getStorePath</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~getTransactionSummary">getTransactionSummary</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~getTransactionTypes">getTransactionTypes</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~getTransactions">getTransactions</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~getTransactionsByDays">getTransactionsByDays</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~loadStore">loadStore</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~saveStore">saveStore</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~startAutoSync">startAutoSync</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~stopAutoSync">stopAutoSync</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_transaction-store.html#~syncTransactions">syncTransactions</a></li></ul></li><li><a href="module-server_analytics_vessel-history-store.html">server/analytics/vessel-history-store</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~clearStore">clearStore</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~ensureDir">ensureDir</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~fetchAllVessels">fetchAllVessels</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~fetchVesselHistory">fetchVesselHistory</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~generateDepartureId">generateDepartureId</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~getDepartures">getDepartures</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~getDeparturesBefore">getDeparturesBefore</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~getDeparturesByDays">getDeparturesByDays</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~getRouteHijackingRisks">getRouteHijackingRisks</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~getStoreInfo">getStoreInfo</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~getStorePath">getStorePath</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~getSyncProgress">getSyncProgress</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~getVesselTrips">getVesselTrips</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~loadStore">loadStore</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~migrateTankerCargo">migrateTankerCargo</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~parseGameDate">parseGameDate</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~saveStore">saveStore</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~startAutoSync">startAutoSync</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~startBackgroundSync">startBackgroundSync</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~stopAutoSync">stopAutoSync</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~stopSync">stopSync</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~syncNextVesselInRotation">syncNextVesselInRotation</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~syncSpecificVessels">syncSpecificVessels</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~syncVesselHistory">syncVesselHistory</a></li><li data-type='method' style='display: none;'><a href="module-server_analytics_vessel-history-store.html#~transformToAuditEntry">transformToAuditEntry</a></li></ul></li><li><a href="module-server_automation.html">server/automation</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_automation.html#~getRandomInterval">getRandomInterval</a></li><li data-type='method' style='display: none;'><a href="module-server_automation.html#~initialize">initialize</a></li><li data-type='method' style='display: none;'><a href="module-server_automation.html#~loadSettings">loadSettings</a></li><li data-type='method' style='display: none;'><a href="module-server_automation.html#~parseInterval">parseInterval</a></li><li data-type='method' style='display: none;'><a href="module-server_automation.html#~restartAutoRepair">restartAutoRepair</a></li><li data-type='method' style='display: none;'><a href="module-server_automation.html#~runAutoRepair">runAutoRepair</a></li><li data-type='method' style='display: none;'><a href="module-server_automation.html#~scheduleAutoRepair">scheduleAutoRepair</a></li></ul></li><li><a href="module-server_autopilot.html">server/autopilot</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~analyzeVesselDepartures">analyzeVesselDepartures</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~autoRebuyAll">autoRebuyAll</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~checkPriceAlerts">checkPriceAlerts</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~checkTelegramPriceAlerts">checkTelegramPriceAlerts</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~countActiveCampaignTypes">countActiveCampaignTypes</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~fastEventLoop">fastEventLoop</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~getGameIndexCached">getGameIndexCached</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~initializeAutopilotState">initializeAutopilotState</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~isAutopilotPaused">isAutopilotPaused</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~pauseAutopilot">pauseAutopilot</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~resumeAutopilot">resumeAutopilot</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~setBroadcastFunction">setBroadcastFunction</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~slowEventLoop">slowEventLoop</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~startMainEventLoop">startMainEventLoop</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~tryUpdateAllData">tryUpdateAllData</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~updateAllData">updateAllData</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~updateCampaigns">updateCampaigns</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~updateDrydockCount">updateDrydockCount</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~updatePrices">updatePrices</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~updateRepairCount">updateRepairCount</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~updateUnreadMessages">updateUnreadMessages</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot.html#~updateVesselCount">updateVesselCount</a></li></ul></li><li><a href="module-server_autopilot_pilot_atmosphere_broker.html">server/autopilot/pilot_atmosphere_broker</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_atmosphere_broker.html#~autoRebuyCO2">autoRebuyCO2</a></li></ul></li><li><a href="module-server_autopilot_pilot_barrel_boss.html">server/autopilot/pilot_barrel_boss</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_barrel_boss.html#~autoRebuyFuel">autoRebuyFuel</a></li></ul></li><li><a href="module-server_autopilot_pilot_captain_blackbeard.html">server/autopilot/pilot_captain_blackbeard</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_captain_blackbeard.html#~autoNegotiateHijacking">autoNegotiateHijacking</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_captain_blackbeard.html#~processHijackingCase">processHijackingCase</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_captain_blackbeard.html#~saveToHistory">saveToHistory</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_captain_blackbeard.html#~wait">wait</a></li></ul></li><li><a href="module-server_autopilot_pilot_cargo_marshal.html">server/autopilot/pilot_cargo_marshal</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_cargo_marshal.html#~autoDepartVessels">autoDepartVessels</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_cargo_marshal.html#~calculateRemainingDemand">calculateRemainingDemand</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_cargo_marshal.html#~departVessels">departVessels</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_cargo_marshal.html#~getTotalCapacity">getTotalCapacity</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_cargo_marshal.html#~resetFuelFailedCacheIfIncreased">resetFuelFailedCacheIfIncreased</a></li></ul></li><li><a href="module-server_autopilot_pilot_drydock_master.html">server/autopilot/pilot_drydock_master</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_drydock_master.html#~autoDrydockVessels">autoDrydockVessels</a></li></ul></li><li><a href="module-server_autopilot_pilot_fair_hand.html">server/autopilot/pilot_fair_hand</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_fair_hand.html#~autoCoop">autoCoop</a></li></ul></li><li><a href="module-server_autopilot_pilot_harbormaster.html">server/autopilot/pilot_harbormaster</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_harbormaster.html#~autoAnchorPointPurchase">autoAnchorPointPurchase</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_harbormaster.html#~setBroadcastFunction">setBroadcastFunction</a></li></ul></li><li><a href="module-server_autopilot_pilot_reputation_chief.html">server/autopilot/pilot_reputation_chief</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_reputation_chief.html#~autoCampaignRenewal">autoCampaignRenewal</a></li></ul></li><li><a href="module-server_autopilot_pilot_staff_captain.html">server/autopilot/pilot_staff_captain</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_staff_captain.html#~manageStaffMorale">manageStaffMorale</a></li></ul></li><li><a href="module-server_autopilot_pilot_the_purser.html">server/autopilot/pilot_the_purser</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_the_purser.html#~autoBuyStock">autoBuyStock</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_the_purser.html#~autoSellStock">autoSellStock</a></li><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_the_purser.html#~clearPurchasedCache">clearPurchasedCache</a></li></ul></li><li><a href="module-server_autopilot_pilot_yard_foreman.html">server/autopilot/pilot_yard_foreman</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_autopilot_pilot_yard_foreman.html#~autoRepairVessels">autoRepairVessels</a></li></ul></li><li><a href="module-server_cache.html">server/cache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_cache.html#~clearAllCaches">clearAllCaches</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~getAllianceCache">getAllianceCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~getCampaignCache">getCampaignCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~getCompanyCache">getCompanyCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~getCoopCache">getCoopCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~getGameIndexCache">getGameIndexCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~invalidateCampaignCache">invalidateCampaignCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~invalidateCoopCache">invalidateCoopCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~invalidateGameIndexCache">invalidateGameIndexCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~isCacheValid">isCacheValid</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~setAllianceCache">setAllianceCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~setCampaignCache">setCampaignCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~setCompanyCache">setCompanyCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~setCoopCache">setCoopCache</a></li><li data-type='method' style='display: none;'><a href="module-server_cache.html#~setGameIndexCache">setGameIndexCache</a></li></ul></li><li><a href="module-server_certificate.html">server/certificate</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_certificate.html#~createHttpsServer">createHttpsServer</a></li><li data-type='method' style='display: none;'><a href="module-server_certificate.html#~generateCA">generateCA</a></li><li data-type='method' style='display: none;'><a href="module-server_certificate.html#~generateCertificate">generateCertificate</a></li><li data-type='method' style='display: none;'><a href="module-server_certificate.html#~getNetworkIPs">getNetworkIPs</a></li><li data-type='method' style='display: none;'><a href="module-server_certificate.html#~isCertificateInstalled">isCertificateInstalled</a></li><li data-type='method' style='display: none;'><a href="module-server_certificate.html#~loadCertificate">loadCertificate</a></li></ul></li><li><a href="module-server_chatbot.html">server/chatbot</a></li><li><a href="module-server_chatbot_commands.html">server/chatbot/commands</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_chatbot_commands.html#~generateForecastText">generateForecastText</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_commands.html#~getBroadcastDir">getBroadcastDir</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_commands.html#~getEnabledBroadcastTemplates">getEnabledBroadcastTemplates</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_commands.html#~handleForecastCommand">handleForecastCommand</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_commands.html#~handleHelpCommand">handleHelpCommand</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_commands.html#~handleMsgCommand">handleMsgCommand</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_commands.html#~handleWelcomeCommand">handleWelcomeCommand</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_commands.html#~hasManagementRole">hasManagementRole</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_commands.html#~loadBroadcastTemplates">loadBroadcastTemplates</a></li></ul></li><li><a href="module-server_chatbot_executor.html">server/chatbot/executor</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_chatbot_executor.html#~executeCommand">executeCommand</a></li></ul></li><li><a href="module-server_chatbot_parser.html">server/chatbot/parser</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~findCustomCommand">findCustomCommand</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~hasManagementRole">hasManagementRole</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~isCommandAllowedInChannel">isCommandAllowedInChannel</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~processAllianceMessage">processAllianceMessage</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~processPrivateMessage">processPrivateMessage</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~processQueue">processQueue</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~queueCommand">queueCommand</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~resolveCommandName">resolveCommandName</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~validateCommandArguments">validateCommandArguments</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~validateForecastArguments">validateForecastArguments</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_parser.html#~validateWelcomeArguments">validateWelcomeArguments</a></li></ul></li><li><a href="module-server_chatbot_scheduler.html">server/chatbot/scheduler</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_chatbot_scheduler.html#~scheduleDailyForecast">scheduleDailyForecast</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_scheduler.html#~sendDailyForecast">sendDailyForecast</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_scheduler.html#~setupScheduledTasks">setupScheduledTasks</a></li></ul></li><li><a href="module-server_chatbot_sender.html">server/chatbot/sender</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~broadcastDmFailureNotification">broadcastDmFailureNotification</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~broadcastDmQueuedNotification">broadcastDmQueuedNotification</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~broadcastRateLimitNotification">broadcastRateLimitNotification</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~getDmQueueStatus">getDmQueueStatus</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~processDmQueue">processDmQueue</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~queuePrivateMessage">queuePrivateMessage</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~sendAllianceMessage">sendAllianceMessage</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~sendErrorMessage">sendErrorMessage</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~sendPrivateMessage">sendPrivateMessage</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~sendPrivateMessageDirect">sendPrivateMessageDirect</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_sender.html#~sendResponse">sendResponse</a></li></ul></li><li><a href="module-server_chatbot_settings.html">server/chatbot/settings</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_chatbot_settings.html#~getDefaultChatBotObject">getDefaultChatBotObject</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_settings.html#~hasManagementRole">hasManagementRole</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_settings.html#~loadSettings">loadSettings</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_settings.html#~mapChatBotObjectToFlatSettings">mapChatBotObjectToFlatSettings</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_settings.html#~mapSettingsToChatBotObject">mapSettingsToChatBotObject</a></li><li data-type='method' style='display: none;'><a href="module-server_chatbot_settings.html#~updateSettings">updateSettings</a></li></ul></li><li><a href="module-server_config.html">server/config</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_config.html#~getAppBaseDir">getAppBaseDir</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~getAppDataDir">getAppDataDir</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~getAppPlatformCookie">getAppPlatformCookie</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~getAppVersionCookie">getAppVersionCookie</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~getInternalBaseUrl">getInternalBaseUrl</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~getLocalAppDataDir">getLocalAppDataDir</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~getLogDir">getLogDir</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~getSessionCookie">getSessionCookie</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~getSettingsDir">getSettingsDir</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~loadStartupSettings">loadStartupSettings</a></li><li data-type='method' style='display: none;'><a href="module-server_config.html#~setSessionCookie">setSessionCookie</a></li></ul></li><li><a href="module-server_gameapi.html">server/gameapi</a></li><li><a href="module-server_gameapi_alliance.html">server/gameapi/alliance</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_gameapi_alliance.html#~fetchUserContribution">fetchUserContribution</a></li></ul></li><li><a href="module-server_gameapi_bunker.html">server/gameapi/bunker</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_gameapi_bunker.html#~fetchBunkerState">fetchBunkerState</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_bunker.html#~fetchPrices">fetchPrices</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_bunker.html#~purchaseCO2">purchaseCO2</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_bunker.html#~purchaseFuel">purchaseFuel</a></li></ul></li><li><a href="module-server_gameapi_campaign.html">server/gameapi/campaign</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_gameapi_campaign.html#~activateCampaign">activateCampaign</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_campaign.html#~fetchCampaigns">fetchCampaigns</a></li></ul></li><li><a href="module-server_gameapi_maintenance.html">server/gameapi/maintenance</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_gameapi_maintenance.html#~bulkRepairVessels">bulkRepairVessels</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_maintenance.html#~fetchRepairCount">fetchRepairCount</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_maintenance.html#~getMaintenanceCost">getMaintenanceCost</a></li></ul></li><li><a href="module-server_gameapi_port.html">server/gameapi/port</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_gameapi_port.html#~fetchAssignedPorts">fetchAssignedPorts</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_port.html#~fetchAutoPrice">fetchAutoPrice</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_port.html#~getAssignedPorts">getAssignedPorts</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_port.html#~getRoutesByPorts">getRoutesByPorts</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_port.html#~getVesselPorts">getVesselPorts</a></li></ul></li><li><a href="module-server_gameapi_util.html">server/gameapi/util</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_gameapi_util.html#~fetchEventData">fetchEventData</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_util.html#~fetchUnreadMessages">fetchUnreadMessages</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_util.html#~getGameIndex">getGameIndex</a></li></ul></li><li><a href="module-server_gameapi_vessel.html">server/gameapi/vessel</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_gameapi_vessel.html#~departVessel">departVessel</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_vessel.html#~fetchVessels">fetchVessels</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_vessel.html#~getAllUserVessels">getAllUserVessels</a></li><li data-type='method' style='display: none;'><a href="module-server_gameapi_vessel.html#~getVesselHistory">getVesselHistory</a></li></ul></li><li><a href="module-server_middleware_index.html">server/middleware/index</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_middleware_index.html#~setupMiddleware">setupMiddleware</a></li></ul></li><li><a href="module-server_routes_alliance.html">server/routes/alliance</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.GET/api/alliance-high-scores">GET /api/alliance-high-scores</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.GET/api/alliance-info">GET /api/alliance-info</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.GET/api/alliance-info/:id">GET /api/alliance-info/:id</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.GET/api/alliance-members">GET /api/alliance-members</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.GET/api/alliance-members/:id">GET /api/alliance-members/:id</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.GET/api/alliance-settings">GET /api/alliance-settings</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.GET/api/chat">GET /api/chat</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.GET/api/league-info">GET /api/league-info</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.POST/api/alliance-accept-user">POST /api/alliance-accept-user</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.POST/api/alliance-decline-user">POST /api/alliance-decline-user</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.POST/api/alliance-leave">POST /api/alliance-leave</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.POST/api/alliance-queue-pool">POST /api/alliance-queue-pool</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.POST/api/alliance-update-user-role">POST /api/alliance-update-user-role</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.POST/api/chat/mark-read">POST /api/chat/mark-read</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.POST/api/company-name">POST /api/company-name</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_alliance.html#.POST/api/send-message">POST /api/send-message</a></li></ul></li><li><a href="module-server_routes_alliance-logo.html">server/routes/alliance-logo</a></li><li><a href="module-server_routes_alliances.html">server/routes/alliances</a></li><li><a href="module-server_routes_analytics.html">server/routes/analytics</a></li><li><a href="module-server_routes_anchor.html">server/routes/anchor</a></li><li><a href="module-server_routes_broadcast.html">server/routes/broadcast</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_broadcast.html#~ensureDirectory">ensureDirectory</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_broadcast.html#~getTemplatesFilePath">getTemplatesFilePath</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_broadcast.html#~loadTemplates">loadTemplates</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_broadcast.html#~saveTemplates">saveTemplates</a></li></ul></li><li><a href="module-server_routes_coop.html">server/routes/coop</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_coop.html#.GET/api/coop/data">GET /api/coop/data</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_coop.html#.POST/api/coop/send-max">POST /api/coop/send-max</a></li></ul></li><li><a href="module-server_routes_forecast.html">server/routes/forecast</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~convertCESTToTimezone">convertCESTToTimezone</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~generateChatbotText">generateChatbotText</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~generateMetadata">generateMetadata</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~getDaysInMonth">getDaysInMonth</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~getForecastDataPath">getForecastDataPath</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~getMonthForDay">getMonthForDay</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~getNextDayData">getNextDayData</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~getPreviousDayData">getPreviousDayData</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~getServerLocalTimezone">getServerLocalTimezone</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~getTimezoneOffsetHours">getTimezoneOffsetHours</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~getValidTimezones">getValidTimezones</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_forecast.html#~parseNumericOffset">parseNumericOffset</a></li></ul></li><li><a href="module-server_routes_game.html">server/routes/game</a></li><li><a href="module-server_routes_game_autopilot.html">server/routes/game/autopilot</a></li><li><a href="module-server_routes_game_bunker.html">server/routes/game/bunker</a></li><li><a href="module-server_routes_game_depart.html">server/routes/game/depart</a></li><li><a href="module-server_routes_game_maintenance.html">server/routes/game/maintenance</a></li><li><a href="module-server_routes_game_marketing.html">server/routes/game/marketing</a></li><li><a href="module-server_routes_game_user.html">server/routes/game/user</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_game_user.html#~compareVersions">compareVersions</a></li></ul></li><li><a href="module-server_routes_game_vessel.html">server/routes/game/vessel</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_game_vessel.html#~refreshAndBroadcastHeader">refreshAndBroadcastHeader</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_game_vessel.html#~validateImageData">validateImageData</a></li></ul></li><li><a href="module-server_routes_harbor-map.html">server/routes/harbor-map</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_harbor-map.html#~escapeCSVFormula">escapeCSVFormula</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_harbor-map.html#~formatHistoryAsTXT">formatHistoryAsTXT</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_harbor-map.html#~getGameIndexCached">getGameIndexCached</a></li></ul></li><li><a href="module-server_routes_health.html">server/routes/health</a></li><li><a href="module-server_routes_messenger.html">server/routes/messenger</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_messenger.html#.GET/api/contact/get-contacts">GET /api/contact/get-contacts</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_messenger.html#.GET/api/hijacking/get-cases">GET /api/hijacking/get-cases</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_messenger.html#.GET/api/messenger/get-chats">GET /api/messenger/get-chats</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_messenger.html#.POST/api/messenger/delete-chat">POST /api/messenger/delete-chat</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_messenger.html#.POST/api/messenger/get-messages">POST /api/messenger/get-messages</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_messenger.html#.POST/api/messenger/send-private">POST /api/messenger/send-private</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_messenger.html#.POST/api/user/search">POST /api/user/search</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_messenger.html#~ensureHijackHistoryDir">ensureHijackHistoryDir</a></li></ul></li><li><a href="module-server_routes_poi.html">server/routes/poi</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~ensureCacheDir">ensureCacheDir</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~fetchAllMuseumsFromAPI">fetchAllMuseumsFromAPI</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~fetchAllWrecksFromAPI">fetchAllWrecksFromAPI</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~filterPOIsByBbox">filterPOIsByBbox</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~initializePOICache">initializePOICache</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~isCacheValid">isCacheValid</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~loadFromCache">loadFromCache</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~reduceWreckData">reduceWreckData</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~saveToCache">saveToCache</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_poi.html#~startAutomaticCacheRefresh">startAutomaticCacheRefresh</a></li></ul></li><li><a href="module-server_routes_route-planner.html">server/routes/route-planner</a></li><li><a href="module-server_routes_server-config.html">server/routes/server-config</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_server-config.html#~getDirectoryStats">getDirectoryStats</a></li></ul></li><li><a href="module-server_routes_settings.html">server/routes/settings</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_settings.html#.GET/api/settings">GET /api/settings</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_settings.html#.POST/api/settings">POST /api/settings</a></li></ul></li><li><a href="module-server_routes_staff.html">server/routes/staff</a></li><li><a href="module-server_routes_stock.html">server/routes/stock</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_routes_stock.html#.GET/api/stock/check-company-age">GET /api/stock/check-company-age</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_stock.html#.GET/api/stock/finance-overview">GET /api/stock/finance-overview</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_stock.html#.GET/api/stock/market">GET /api/stock/market</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_stock.html#.GET/api/stock/purchase-times">GET /api/stock/purchase-times</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_stock.html#.GET/api/stock/recent-ipos">GET /api/stock/recent-ipos</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_stock.html#.POST/api/stock/increase-stock-for-sale">POST /api/stock/increase-stock-for-sale</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_stock.html#.POST/api/stock/purchase">POST /api/stock/purchase</a></li><li data-type='method' style='display: none;'><a href="module-server_routes_stock.html#.POST/api/stock/sell">POST /api/stock/sell</a></li></ul></li><li><a href="module-server_routes_transactions.html">server/routes/transactions</a></li><li><a href="module-server_routes_vessel-image.html">server/routes/vessel-image</a></li><li><a href="module-server_scheduler.html">server/scheduler</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_scheduler.html#~initScheduler">initScheduler</a></li><li data-type='method' style='display: none;'><a href="module-server_scheduler.html#~isServerReady">isServerReady</a></li></ul></li><li><a href="module-server_services_alliance-indexer.html">server/services/alliance-indexer</a></li><li><a href="module-server_settings-schema.html">server/settings-schema</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_settings-schema.html#~getDefault">getDefault</a></li><li data-type='method' style='display: none;'><a href="module-server_settings-schema.html#~getDefaults">getDefaults</a></li><li data-type='method' style='display: none;'><a href="module-server_settings-schema.html#~getRequiredKeys">getRequiredKeys</a></li><li data-type='method' style='display: none;'><a href="module-server_settings-schema.html#~getSettingsFilePath">getSettingsFilePath</a></li><li data-type='method' style='display: none;'><a href="module-server_settings-schema.html#~initializeSettings">initializeSettings</a></li><li data-type='method' style='display: none;'><a href="module-server_settings-schema.html#~saveSettings">saveSettings</a></li><li data-type='method' style='display: none;'><a href="module-server_settings-schema.html#~validateSettings">validateSettings</a></li><li data-type='method' style='display: none;'><a href="module-server_settings-schema.html#~validateValue">validateValue</a></li></ul></li><li><a href="module-server_state.html">server/state</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_state.html#~getAllLocks">getAllLocks</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getAutopilotState">getAutopilotState</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getBunkerState">getBunkerState</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getCampaignStatus">getCampaignStatus</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getCoopData">getCoopData</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getDrydockCount">getDrydockCount</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getEventData">getEventData</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getHeaderData">getHeaderData</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getLastCO2Alert">getLastCO2Alert</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getLastFuelAlert">getLastFuelAlert</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getLockStatus">getLockStatus</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getPrices">getPrices</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getRepairCount">getRepairCount</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getSettings">getSettings</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getStaffData">getStaffData</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getUserState">getUserState</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~getVesselCounts">getVesselCounts</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~isAutopilotPaused">isAutopilotPaused</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~setAutopilotPaused">setAutopilotPaused</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~setAutopilotState">setAutopilotState</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~setLastCO2Alert">setLastCO2Alert</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~setLastFuelAlert">setLastFuelAlert</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~setLockStatus">setLockStatus</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateBunkerState">updateBunkerState</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateCampaignStatus">updateCampaignStatus</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateCoopData">updateCoopData</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateDrydockCount">updateDrydockCount</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateEventData">updateEventData</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateHeaderData">updateHeaderData</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updatePrices">updatePrices</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateRepairCount">updateRepairCount</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateSettings">updateSettings</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateStaffData">updateStaffData</a></li><li data-type='method' style='display: none;'><a href="module-server_state.html#~updateVesselCounts">updateVesselCounts</a></li></ul></li><li><a href="module-server_utils_api.html">server/utils/api</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~apiCall">apiCall</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~apiCallWithRetry">apiCallWithRetry</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~checkAndUpdateAllianceId">checkAndUpdateAllianceId</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~getAllianceId">getAllianceId</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~getAllianceName">getAllianceName</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~getChatFeed">getChatFeed</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~getCompanyName">getCompanyName</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~getUserCompanyName">getUserCompanyName</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~getUserId">getUserId</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~initializeAlliance">initializeAlliance</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~setAllianceId">setAllianceId</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_api.html#~sleep">sleep</a></li></ul></li><li><a href="module-server_utils_audit-logger.html">server/utils/audit-logger</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_audit-logger.html#~auditLog">auditLog</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_audit-logger.html#~formatCurrency">formatCurrency</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_audit-logger.html#~formatNumber">formatNumber</a></li></ul></li><li><a href="module-server_utils_encryption.html">server/utils/encryption</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_encryption.html#~decryptData">decryptData</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_encryption.html#~deleteEncryptedData">deleteEncryptedData</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_encryption.html#~encryptData">encryptData</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_encryption.html#~getEncryptionInfo">getEncryptionInfo</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_encryption.html#~isEncrypted">isEncrypted</a></li></ul></li><li><a href="module-server_utils_fuel-calculator.html">server/utils/fuel-calculator</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_fuel-calculator.html#~calculateFuelConsumption">calculateFuelConsumption</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_fuel-calculator.html#~calculateFuelFromFormula">calculateFuelFromFormula</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_fuel-calculator.html#~getFuelConsumptionDisplay">getFuelConsumptionDisplay</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_fuel-calculator.html#~getVesselFuelData">getVesselFuelData</a></li></ul></li><li><a href="module-server_utils_ipo-tracker.html">server/utils/ipo-tracker</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_ipo-tracker.html#~ensureIpoTrackingFile">ensureIpoTrackingFile</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_ipo-tracker.html#~getHighestSeenUserId">getHighestSeenUserId</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_ipo-tracker.html#~getSeenIpoUserIds">getSeenIpoUserIds</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_ipo-tracker.html#~hasSeenIpo">hasSeenIpo</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_ipo-tracker.html#~initializeWithIpos">initializeWithIpos</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_ipo-tracker.html#~isFirstCheck">isFirstCheck</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_ipo-tracker.html#~markIpoAsSeen">markIpoAsSeen</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_ipo-tracker.html#~saveIpoTrackingFile">saveIpoTrackingFile</a></li></ul></li><li><a href="module-server_utils_logger.html">server/utils/logger</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_logger.html#~debug">debug</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_logger.html#~error">error</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_logger.html#~info">info</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_logger.html#~isDebugMode">isDebugMode</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_logger.html#~loadLogLevel">loadLogLevel</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_logger.html#~warn">warn</a></li></ul></li><li><a href="module-server_utils_migrate-harbor-fees.html">server/utils/migrate-harbor-fees</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_migrate-harbor-fees.html#~migrateAllHarborFees">migrateAllHarborFees</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_migrate-harbor-fees.html#~migrateHarborFeesForUser">migrateHarborFeesForUser</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_migrate-harbor-fees.html#~resolveVesselNameToId">resolveVesselNameToId</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_migrate-harbor-fees.html#~timestampToMySQLDatetime">timestampToMySQLDatetime</a></li></ul></li><li><a href="module-server_utils_read-tracker.html">server/utils/read-tracker</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_read-tracker.html#~ensureReadTrackingFile">ensureReadTrackingFile</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_read-tracker.html#~getLastReadTimestamp">getLastReadTimestamp</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_read-tracker.html#~saveReadTrackingFile">saveReadTrackingFile</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_read-tracker.html#~updateLastReadTimestamp">updateLastReadTimestamp</a></li></ul></li><li><a href="module-server_utils_session-manager.html">server/utils/session-manager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~deleteSession">deleteSession</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~getAllUserIds">getAllUserIds</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~getAvailableSessions">getAvailableSessions</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~getSession">getSession</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~getSessionsPath">getSessionsPath</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~hasSession">hasSession</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~loadAllSessions">loadAllSessions</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~loadSessions">loadSessions</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~migrateToEncrypted">migrateToEncrypted</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~saveSession">saveSession</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_session-manager.html#~saveSessions">saveSessions</a></li></ul></li><li><a href="module-server_utils_telegram.html">server/utils/telegram</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_telegram.html#~checkGreenPrices">checkGreenPrices</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_telegram.html#~sendPriceAlert">sendPriceAlert</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_telegram.html#~sendTelegramMessage">sendTelegramMessage</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_telegram.html#~testTelegramConnection">testTelegramConnection</a></li></ul></li><li><a href="module-server_utils_trip-data-store.html">server/utils/trip-data-store</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~enrichHistoryWithTripData">enrichHistoryWithTripData</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~ensureDirectory">ensureDirectory</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~findLookupDataFuzzy">findLookupDataFuzzy</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~findTripDataFuzzy">findTripDataFuzzy</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~getFilePath">getFilePath</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~getTripData">getTripData</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~isMigrationCompleted">isMigrationCompleted</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~loadTripData">loadTripData</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~markMigrationCompleted">markMigrationCompleted</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~migrateFromOldStores">migrateFromOldStores</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~saveHarborFee">saveHarborFee</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~saveTripData">saveTripData</a></li><li data-type='method' style='display: none;'><a href="module-server_utils_trip-data-store.html#~saveTripDataToDisk">saveTripDataToDisk</a></li></ul></li><li><a href="module-server_websocket.html">server/websocket</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket.html#~initWebSocket">initWebSocket</a></li></ul></li><li><a href="module-server_websocket_broadcaster.html">server/websocket/broadcaster</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_broadcaster.html#~broadcast">broadcast</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_broadcaster.html#~broadcastBunkerUpdate">broadcastBunkerUpdate</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_broadcaster.html#~broadcastHarborMapRefresh">broadcastHarborMapRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_broadcaster.html#~broadcastToUser">broadcastToUser</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_broadcaster.html#~getWebSocketServer">getWebSocketServer</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_broadcaster.html#~setWebSocketServer">setWebSocketServer</a></li></ul></li><li><a href="module-server_websocket_chat-refresh.html">server/websocket/chat-refresh</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_chat-refresh.html#~performChatRefresh">performChatRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_chat-refresh.html#~setMessengerRefreshFn">setMessengerRefreshFn</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_chat-refresh.html#~startChatAutoRefresh">startChatAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_chat-refresh.html#~stopChatAutoRefresh">stopChatAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_chat-refresh.html#~triggerImmediateChatRefresh">triggerImmediateChatRefresh</a></li></ul></li><li><a href="module-server_websocket_hijacking-cache.html">server/websocket/hijacking-cache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_hijacking-cache.html#~getCachedHijackingCase">getCachedHijackingCase</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_hijacking-cache.html#~invalidateHijackingCase">invalidateHijackingCase</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_hijacking-cache.html#~readLocalCaseFile">readLocalCaseFile</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_hijacking-cache.html#~saveLocalCaseFile">saveLocalCaseFile</a></li></ul></li><li><a href="module-server_websocket_hijacking-refresh.html">server/websocket/hijacking-refresh</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_hijacking-refresh.html#~performHijackingRefresh">performHijackingRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_hijacking-refresh.html#~startHijackingAutoRefresh">startHijackingAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_hijacking-refresh.html#~stopHijackingAutoRefresh">stopHijackingAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_hijacking-refresh.html#~triggerImmediateHijackingRefresh">triggerImmediateHijackingRefresh</a></li></ul></li><li><a href="module-server_websocket_ipo-refresh.html">server/websocket/ipo-refresh</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_ipo-refresh.html#~getFreshIpos">getFreshIpos</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_ipo-refresh.html#~performIpoRefresh">performIpoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_ipo-refresh.html#~resetIpoCache">resetIpoCache</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_ipo-refresh.html#~sendToAllianceChat">sendToAllianceChat</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_ipo-refresh.html#~startIpoAutoRefresh">startIpoAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_ipo-refresh.html#~stopIpoAutoRefresh">stopIpoAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_ipo-refresh.html#~triggerImmediateIpoRefresh">triggerImmediateIpoRefresh</a></li></ul></li><li><a href="module-server_websocket_message-cache.html">server/websocket/message-cache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_message-cache.html#~getProcessedMessageIds">getProcessedMessageIds</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_message-cache.html#~getProcessedMessagesCachePath">getProcessedMessagesCachePath</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_message-cache.html#~loadProcessedMessageCache">loadProcessedMessageCache</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_message-cache.html#~saveProcessedMessageCache">saveProcessedMessageCache</a></li></ul></li><li><a href="module-server_websocket_messenger-cache.html">server/websocket/messenger-cache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-cache.html#~getCachedMessengerChats">getCachedMessengerChats</a></li></ul></li><li><a href="module-server_websocket_messenger-content-cache.html">server/websocket/messenger-content-cache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~deleteChatFromCache">deleteChatFromCache</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~ensureCacheDir">ensureCacheDir</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~flushCache">flushCache</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~getCacheStats">getCacheStats</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~getCachedChatList">getCachedChatList</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~getCachedChatMessages">getCachedChatMessages</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~getMessengerCachePath">getMessengerCachePath</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~hasNewMessages">hasNewMessages</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~loadMessengerCache">loadMessengerCache</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~markChatAsReadInCache">markChatAsReadInCache</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~saveMessengerCache">saveMessengerCache</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~updateChatList">updateChatList</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-content-cache.html#~updateChatMessages">updateChatMessages</a></li></ul></li><li><a href="module-server_websocket_messenger-refresh.html">server/websocket/messenger-refresh</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-refresh.html#~performMessengerRefresh">performMessengerRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-refresh.html#~startMessengerAutoRefresh">startMessengerAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-refresh.html#~stopMessengerAutoRefresh">stopMessengerAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_messenger-refresh.html#~triggerImmediateMessengerRefresh">triggerImmediateMessengerRefresh</a></li></ul></li><li><a href="module-server_websocket_staff-refresh.html">server/websocket/staff-refresh</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-server_websocket_staff-refresh.html#~performStaffRefresh">performStaffRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_staff-refresh.html#~startStaffAutoRefresh">startStaffAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_staff-refresh.html#~stopStaffAutoRefresh">stopStaffAutoRefresh</a></li><li data-type='method' style='display: none;'><a href="module-server_websocket_staff-refresh.html#~triggerImmediateStaffRefresh">triggerImmediateStaffRefresh</a></li></ul></li><li><a href="module-stock-manager.html">stock-manager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.calculatePriceStats">calculatePriceStats</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.closeStockManager">closeStockManager</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.initStockManager">initStockManager</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.initializeChart">initializeChart</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.openCompanyDetail">openCompanyDetail</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.renderChartSection">renderChartSection</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.showBuyDialog">showBuyDialog</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.showSellDialog">showSellDialog</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.showStockManager">showStockManager</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#.showStockManagerIpoAlerts">showStockManagerIpoAlerts</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~calculateMA">calculateMA</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~calculateSharePriceTier">calculateSharePriceTier</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~closeCompanyDetail">closeCompanyDetail</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~createEnhancedChart">createEnhancedChart</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~createMASeries">createMASeries</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~createMarketRow">createMarketRow</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~createTierRow">createTierRow</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~destroyChart">destroyChart</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~escapeHtml">escapeHtml</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~estimatePurchaseDateFromPrice">estimatePurchaseDateFromPrice</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~filterDataByTimeframe">filterDataByTimeframe</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~formatPurchaseDate">formatPurchaseDate</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~generateMarketRowHtml">generateMarketRowHtml</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~handleIncreaseSharesClick">handleIncreaseSharesClick</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~initTooltipSystem">initTooltipSystem</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~loadInvestments">loadInvestments</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~loadInvestors">loadInvestors</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~loadIpoAlerts">loadIpoAlerts</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~loadMarket">loadMarket</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~loadMarketList">loadMarketList</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~loadMoreMarketItems">loadMoreMarketItems</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~loadPortfolio">loadPortfolio</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~refreshIpoAlertTab">refreshIpoAlertTab</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~renderIpoAlertsTable">renderIpoAlertsTable</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~resetMarketState">resetMarketState</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~setupChartToolbar">setupChartToolbar</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~setupCompanyNameClickHandlers">setupCompanyNameClickHandlers</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~setupInvestmentSellButtons">setupInvestmentSellButtons</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~setupMarketRowClickHandlers">setupMarketRowClickHandlers</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~setupMarketScrollHandler">setupMarketScrollHandler</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~setupTooltips">setupTooltips</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~showIncreaseSharesModal">showIncreaseSharesModal</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~switchTab">switchTab</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~updateChart">updateChart</a></li><li data-type='method' style='display: none;'><a href="module-stock-manager.html#~updateMovingAverages">updateMovingAverages</a></li></ul></li><li><a href="module-ui-dialogs.html">ui-dialogs</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-ui-dialogs.html#.buyCampaign">buyCampaign</a></li><li data-type='method' style='display: none;'><a href="module-ui-dialogs.html#.closeCampaignsOverlay">closeCampaignsOverlay</a></li><li data-type='method' style='display: none;'><a href="module-ui-dialogs.html#.closeSettings">closeSettings</a></li><li data-type='method' style='display: none;'><a href="module-ui-dialogs.html#.showCampaignsOverlay">showCampaignsOverlay</a></li><li data-type='method' style='display: none;'><a href="module-ui-dialogs.html#.showConfirmDialog">showConfirmDialog</a></li><li data-type='method' style='display: none;'><a href="module-ui-dialogs.html#.showContactList">showContactList</a></li><li data-type='method' style='display: none;'><a href="module-ui-dialogs.html#.showPurchaseDialog">showPurchaseDialog</a></li><li data-type='method' style='display: none;'><a href="module-ui-dialogs.html#.showSettings">showSettings</a></li></ul></li><li><a href="module-utils.html">utils</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-utils.html#.escapeHtml">escapeHtml</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.formatCompactNumber">formatCompactNumber</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.formatNumber">formatNumber</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.getCO2PriceClass">getCO2PriceClass</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.getFuelPriceClass">getFuelPriceClass</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.isMobileDevice">isMobileDevice</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.loadBackupInfo">loadBackupInfo</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.loadServerConfig">loadServerConfig</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.registerServiceWorker">registerServiceWorker</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.renderStars">renderStars</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.requestNotificationPermission">requestNotificationPermission</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.showNotification">showNotification</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#.showSideNotification">showSideNotification</a></li><li data-type='method' style='display: none;'><a href="module-utils.html#~formatFileSize">formatFileSize</a></li></ul></li><li><a href="module-vessel-appearance-editor.html">vessel-appearance-editor</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#.getVesselImageOnerror">getVesselImageOnerror</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#.handleVesselImageError">handleVesselImageError</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#.initVesselAppearanceEditor">initVesselAppearanceEditor</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#.openAppearanceEditor">openAppearanceEditor</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#~buildSvgUrl">buildSvgUrl</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#~closeAppearanceEditor">closeAppearanceEditor</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#~getFormData">getFormData</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#~handleImageSelection">handleImageSelection</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#~handleRemoveCustomImage">handleRemoveCustomImage</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#~resetColorValues">resetColorValues</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#~resizeImage">resizeImage</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#~saveAppearance">saveAppearance</a></li><li data-type='method' style='display: none;'><a href="module-vessel-appearance-editor.html#~updateSvgPreview">updateSvgPreview</a></li></ul></li><li><a href="module-vessel-building.html">vessel-building</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-vessel-building.html#.initBuildShipModal">initBuildShipModal</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#.openBuildShipModal">openBuildShipModal</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~applyPerkEffects">applyPerkEffects</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~buildPreviewUrl">buildPreviewUrl</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~calculateBaseRangeFromCapacity">calculateBaseRangeFromCapacity</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~calculateBaseStats">calculateBaseStats</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~calculateGameBaseSpeed">calculateGameBaseSpeed</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~calculatePrice">calculatePrice</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~calculateSpeedForEngine">calculateSpeedForEngine</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~closeBuildShipModal">closeBuildShipModal</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~formatBuildTime">formatBuildTime</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~interpolate">interpolate</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~nextStep">nextStep</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~prevStep">prevStep</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~renderCurrentStep">renderCurrentStep</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~renderStep1">renderStep1</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~renderStep3">renderStep3</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~renderStep4">renderStep4</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~renderStep5">renderStep5</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~submitBuild">submitBuild</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~updateStatsPreview">updateStatsPreview</a></li><li data-type='method' style='display: none;'><a href="module-vessel-building.html#~updateSvgPreview">updateSvgPreview</a></li></ul></li><li><a href="module-vessel-management.html">vessel-management</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-vessel-management.html#.departAllVessels">departAllVessels</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#.openRepairAndDrydockDialog">openRepairAndDrydockDialog</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#.purchaseSingleVessel">purchaseSingleVessel</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#.updateLockStateFromServer">updateLockStateFromServer</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#.updateVesselCount">updateVesselCount</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~createVesselCard">createVesselCard</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~displayFilteredVessels">displayFilteredVessels</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~executeDrydock">executeDrydock</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~getAvailableAnchorSlots">getAvailableAnchorSlots</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~getCO2EfficiencyClass">getCO2EfficiencyClass</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~getCapacityDisplay">getCapacityDisplay</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~getFuelEfficiencyClass">getFuelEfficiencyClass</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~loadCartFromStorage">loadCartFromStorage</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~loadMorePendingVessels">loadMorePendingVessels</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~loadMoreVessels">loadMoreVessels</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~populateDynamicFilters">populateDynamicFilters</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~refreshVesselCardsIfVisible">refreshVesselCardsIfVisible</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~renderDrydockTab">renderDrydockTab</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~renderRepairTab">renderRepairTab</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~saveCartToStorage">saveCartToStorage</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~showRepairAndDrydockDialog">showRepairAndDrydockDialog</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~updateCapacityDropdowns">updateCapacityDropdowns</a></li><li data-type='method' style='display: none;'><a href="module-vessel-management.html#~vesselPassesFilters">vesselPassesFilters</a></li></ul></li><li><a href="module-vessel-selling.html">vessel-selling</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#.bulkSellVessels">bulkSellVessels</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#.closeSellVesselsOverlay">closeSellVesselsOverlay</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#.openSellVesselsOverlay">openSellVesselsOverlay</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#.refreshVesselsForSale">refreshVesselsForSale</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#.setSellFilter">setSellFilter</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#.showSellCart">showSellCart</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~clearSellCartCache">clearSellCartCache</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~displaySellVessels">displaySellVessels</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~fetchAllSellPrices">fetchAllSellPrices</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~getCO2EfficiencyClass">getCO2EfficiencyClass</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~getCapacityDisplay">getCapacityDisplay</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~getFuelEfficiencyClass">getFuelEfficiencyClass</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~groupVesselsByModel">groupVesselsByModel</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~loadSellCartFromCache">loadSellCartFromCache</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~loadUserVesselsForSale">loadUserVesselsForSale</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~removeVesselSelectionFromCart">removeVesselSelectionFromCart</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~saveSellCartToCache">saveSellCartToCache</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~updateBulkSellButton">updateBulkSellButton</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~updateSelectButtonState">updateSelectButtonState</a></li><li data-type='method' style='display: none;'><a href="module-vessel-selling.html#~updateVesselSelectionInCart">updateVesselSelectionInCart</a></li></ul></li></ul></li><li class="nav-list-toggle"><a>Global</a><ul style="display: none;"><li><a href="global.html#buildNav">buildNav</a></li><li><a href="global.html#deleteAllLogs">deleteAllLogs</a></li><li><a href="global.html#escapeCSVFormula">escapeCSVFormula</a></li><li><a href="global.html#express">express</a></li><li><a href="global.html#flushAllToDisk">flushAllToDisk</a></li><li><a href="global.html#formatDetailsAsTXT">formatDetailsAsTXT</a></li><li><a href="global.html#formatFileSize">formatFileSize</a></li><li><a href="global.html#formatLogsAsCSV">formatLogsAsCSV</a></li><li><a href="global.html#formatLogsAsTXT">formatLogsAsTXT</a></li><li><a href="global.html#fs">fs</a></li><li><a href="global.html#generateContainerSvg">generateContainerSvg</a></li><li><a href="global.html#generateTankerSvg">generateTankerSvg</a></li><li><a href="global.html#generateVesselSvg">generateVesselSvg</a></li><li><a href="global.html#getCategoryFromAction">getCategoryFromAction</a></li><li><a href="global.html#getLogEntries">getLogEntries</a></li><li><a href="global.html#getLogFilePath">getLogFilePath</a></li><li><a href="global.html#getLogFileSize">getLogFileSize</a></li><li><a href="global.html#getLogsFromCache">getLogsFromCache</a></li><li><a href="global.html#getSourceFromAction">getSourceFromAction</a></li><li><a href="global.html#getTransactionType">getTransactionType</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#isContainerVessel">isContainerVessel</a></li><li><a href="global.html#isDepartInProgress">isDepartInProgress</a></li><li><a href="global.html#loadBaseContainerSvg">loadBaseContainerSvg</a></li><li><a href="global.html#loadBaseTankerSvg">loadBaseTankerSvg</a></li><li><a href="global.html#loadLogsFromDisk">loadLogsFromDisk</a></li><li><a href="global.html#lockBulkBuyButton">lockBulkBuyButton</a></li><li><a href="global.html#lockCo2Button">lockCo2Button</a></li><li><a href="global.html#lockCoopButtons">lockCoopButtons</a></li><li><a href="global.html#lockDepartButton">lockDepartButton</a></li><li><a href="global.html#lockDrydockButton">lockDrydockButton</a></li><li><a href="global.html#lockFuelButton">lockFuelButton</a></li><li><a href="global.html#lockRepairButton">lockRepairButton</a></li><li><a href="global.html#logAutopilotAction">logAutopilotAction</a></li><li><a href="global.html#publish">publish</a></li><li><a href="global.html#searchInObject">searchInObject</a></li><li><a href="global.html#showAnchorTimer">showAnchorTimer</a></li><li><a href="global.html#shutdown">shutdown</a></li><li><a href="global.html#unlockBulkBuyButton">unlockBulkBuyButton</a></li><li><a href="global.html#unlockCo2Button">unlockCo2Button</a></li><li><a href="global.html#unlockCoopButtons">unlockCoopButtons</a></li><li><a href="global.html#unlockDepartButton">unlockDepartButton</a></li><li><a href="global.html#unlockDrydockButton">unlockDrydockButton</a></li><li><a href="global.html#unlockFuelButton">unlockFuelButton</a></li><li><a href="global.html#unlockRepairButton">unlockRepairButton</a></li><li><a href="global.html#writeLogsToDisk">writeLogsToDisk</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">server/analytics/aggregator.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview Analytics Aggregation Module
 *
 * Reads audit log and trip data to calculate analytics summaries:
 * - Weekly/daily revenue, expenses, profit
 * - Vessel performance metrics
 * - Route profitability analysis
 * - Fuel/CO2 purchase analysis
 * - Harbor fee analysis by port
 * - Contribution tracking
 *
 * All data is LOCAL (JSON files) - no API calls needed.
 * Expected load time: ~100-200ms for full analytics data.
 *
 * @module server/analytics/aggregator
 */

const fs = require('fs').promises;
const path = require('path');
const logger = require('../utils/logger');
const { getLogDir, getAppBaseDir } = require('../config');
const transactionStore = require('./transaction-store');
const vesselHistoryStore = require('./vessel-history-store');
const lookupStore = require('./lookup-store');
const { formatPortAbbreviation } = require('../routes/harbor-map-aggregator');

// Short-term cache for local file reads (audit log, trip data)
// Prevents re-reading the same file multiple times during a single analytics request
const FILE_CACHE_TTL = 2000; // 2 seconds - just enough to cover a single request
const fileCache = new Map(); // key -> { data, timestamp }

// Hijack history directory (for fallback vessel_name lookup) - uses isPkg defined below
let HIJACK_HISTORY_DIR = null;

// Port code to country code mapping
const PORT_COUNTRIES = {
  boston_us: 'US', new_york_city: 'US', philadelphia: 'US', baltimore: 'US', norfolk: 'US',
  mobile: 'US', new_orleans: 'US', houston: 'US', los_angeles: 'US', oakland: 'US',
  portland_l: 'US', seattle: 'US', port_of_alaska: 'US', port_of_nome: 'US', honolulu_harbor: 'US',
  miami: 'US', charleston: 'US', jacksonville: 'US', tampa: 'US', savannah: 'US', wilmington: 'US',
  vancouver: 'CA', halifax: 'CA', canaport_st_john: 'CA', port_of_montreal: 'CA',
  port_prince_rupert: 'CA', st_johns: 'CA', Iqaluit: 'CA', cornor_brook: 'CA',
  puerto_moin: 'CR', puerto_caldera: 'CR', port_of_corinto: 'NI', puerto_cortes: 'HN',
  puerto_de_san_lorenzo: 'HN', port_of_acajutla: 'SV', santo_tomas_de_castilla: 'GT',
  puerto_quetzal: 'GT', puerto_de_belice: 'BZ', veracruz: 'MX', port_of_ensenada: 'MX',
  port_of_manzanillo_colima: 'MX', port_of_altamira: 'MX', port_of_lazaro_cardenas: 'MX', mazatlan: 'MX',
  puerto_de_montevideo: 'UY', tubarao: 'BR', rio_de_janeiro: 'BR', santos: 'BR', rio_grande_br: 'BR',
  port_of_balboa: 'PA', port_of_manzanillo_colon: 'PA', port_of_cartagena: 'CO',
  port_of_buenaventura: 'CO', port_of_guayaquil: 'EC', port_of_callao: 'PE',
  port_of_valparaiso: 'CL', punta_arenas_port: 'CL', antofogasta: 'CL',
  port_of_buenos_aires: 'AR', port_of_ushuaia: 'AR', puerto_madryn: 'AR',
  degrad_des_cannes: 'GF', port_of_georgetown: 'GY', port_of_vila_do_conde: 'BR',
  port_of_fortaleza: 'BR', puerto_cabello: 'VE', salvador: 'BR', suape: 'BR', asuncion: 'PY',
  point_lisas: 'TT', port_of_spain: 'TT', port_of_san_juan: 'PR', port_au_prince: 'HT',
  port_of_boca_china: 'DO', port_of_kingston: 'JM', port_of_bridgetown: 'BB',
  fort_de_france: 'MQ', port_of_st_georges: 'GD', freeport_container_port: 'BS',
  port_of_nassau: 'BS', marsh_harbour: 'BS', mariel: 'CU', santiago_de_cuba: 'CU',
  camden_park: 'VC', port_castries: 'LC', port_of_woodbridge_bay: 'DM',
  port_of_guadeloupe: 'GP', saint_johns: 'AG', port_of_basseterre: 'KN',
  port_said: 'EG', damietta: 'EG', alexandria: 'EG', ain_sukhna_terminal: 'EG',
  alger: 'DZ', oran: 'DZ', casablanca: 'MA', agadir: 'MA', lagos: 'NG',
  cape_town: 'ZA', durban: 'ZA', east_london: 'ZA', gqeberha: 'ZA',
  muqdisho: 'SO', berbera: 'SO', benghazi: 'LY', tripoli: 'LY', marsa_al_brega: 'LY',
  sfax: 'TN', tunis: 'TN', bizerte: 'TN', nouadhibou: 'MR', nouakchott: 'MR',
  praia: 'CV', porteo_grande: 'CV', dakar: 'SN', banjul: 'GM', bissau: 'GW',
  conakry: 'GN', freetown: 'SL', monrovia: 'LR', abidjan: 'CI', tema: 'GH',
  lome: 'TG', cotonou: 'BJ', port_of_onne: 'NG', bata: 'GQ', malabo: 'GQ',
  port_gentil: 'GA', libreville: 'GA', port_of_sao_tome: 'ST', pointe_noire: 'CG',
  matadi: 'CD', cabina: 'AO', luanda: 'AO', lobito: 'AO', soyo: 'AO', namibe: 'AO',
  walvis_bay: 'NA', maputo: 'MZ', beira: 'MZ', nacala: 'MZ', longoni: 'YT',
  moroni: 'KM', toamasina: 'MG', majunga: 'MG', dar_es_salam: 'TZ',
  port_of_zansibar: 'TZ', tanga: 'TZ', mombasa: 'KE', djibouti: 'DJ',
  mitsiwa: 'ER', port_sudan: 'SD',
  brisbane: 'AU', port_of_botany_sydney: 'AU', melbourne: 'AU', fremantle: 'AU',
  port_headland: 'AU', port_of_darwin: 'AU', adelaide: 'AU', port_of_burnie: 'AU',
  port_of_townsville: 'AU', auckland: 'NZ', wellington: 'NZ', port_of_napier: 'NZ',
  christchurch_lyttelton: 'NZ', nelson: 'NZ', bluff: 'NZ',
  port_moresby: 'PG', lae: 'PG', madang: 'PG', male: 'MV', port_victoria: 'SC',
  port_louis: 'MU', lautoka: 'FJ', la_reunion: 'RE', motu_uta: 'FR', nakualofa: 'TO',
  apia: 'WS', port_vila: 'VU', luganville: 'VU', noumea: 'NC', honiara: 'SB',
  stanley: 'FK', hamilton: 'BM',
  oslo: 'NO', bergen: 'NO', goteborg: 'SE', malmo: 'SE', stockholm_norvik: 'SE',
  oulu: 'FI', kokkola: 'FI', pori: 'FI', vousaari_port_of_helsinki: 'FI', kotka: 'FI',
  sankt_peterburg: 'RU', muuga_port_of_tallinn: 'EE', gdansk: 'PL',
  rostock: 'DE', kiel: 'DE', hamburg: 'DE', bremerhaven: 'DE', bremen: 'DE',
  kobenhavn: 'DK', aalborg: 'DK', port_of_aarhus: 'DK',
  amsterdam: 'NL', rotterdam: 'NL', antwerpen: 'BE',
  london: 'GB', teesport: 'GB', belfast: 'GB', liverpool: 'GB', southampton: 'GB',
  port_of_le_havre: 'FR', port_of_dunkerque: 'FR', rade_de_brest: 'FR', bordeaux: 'FR',
  port_of_marseille: 'FR', edoard_herriot_port_of_lyon: 'FR', gennevilliers_port_of_paris: 'FR',
  lisboa: 'PT', sines: 'PT', ponta_delgada: 'PT',
  las_palmas: 'ES', tarragona: 'ES', barcelona: 'ES', cadiz: 'ES', oviedo: 'ES',
  bilbao: 'ES', valencia: 'ES', nalaga: 'ES', port_of_algeciras: 'ES',
  genova: 'IT', napoli: 'IT', porto_di_lido_venezia: 'IT', trieste: 'IT',
  ancona: 'IT', livorna: 'IT', port_of_palermo: 'IT', port_of_cagliari: 'IT', port_of_gioia_tauro: 'IT',
  rijeka_luka: 'HR', split: 'HR', port_of_piraeus: 'GR', thessaloniki: 'GR',
  istanbul: 'TR', samsun: 'TR', izmir: 'TR', varna: 'BG', odesa: 'UA',
  novorossiysk: 'RU', kaliningrad: 'RU', vladivostok: 'RU',
  port_of_petropavlovsk_kamchatskiy: 'RU', providenija: 'RU', abk_morskogo_porta_sabetta: 'RU', murmansk: 'RU',
  giurgiulesti: 'MD', nuuk: 'GL', torshavn: 'FO', akureyri: 'IS', reykjavik: 'IS',
  dublin: 'IE', longyearbyen: 'SJ', malta_freeport: 'MT', poti: 'GE', batumi: 'GE',
  limassol: 'CY', latakia: 'SY', bayrut: 'LB',
  mina_jabal_ali: 'AE', bombay: 'IN', madras: 'IN', calcutta: 'IN', kochi: 'IN',
  visakhapatnam: 'IN', port_klang: 'MY', johor: 'MY', bintulu: 'MY', sarawak: 'MY',
  labuan: 'MY', sepangar: 'MY', tawau: 'MY', port_of_penang: 'MY',
  port_of_singapore: 'SG', jakarta: 'ID', surabaya: 'ID', belawan: 'ID', panjang: 'ID',
  palembang: 'ID', lembar: 'ID', makassar: 'ID', banjrmasin: 'ID', pontianak: 'ID',
  balikpapan: 'ID', ambon: 'ID', gorontalo: 'ID', manokwari: 'ID', sorong: 'ID',
  merauke: 'ID', jayapura: 'ID', tenau: 'ID', waingapu: 'ID',
  bangkok: 'TH', laem_chabang: 'TH', port_of_songkhla: 'TH',
  hong_kong: 'HK', chi_lung: 'TW', port_of_kaohsiung: 'TW',
  manila: 'PH', cebu: 'PH', shanghai: 'CN', qingdao_gang: 'CN', tianjin_xin_gang: 'CN',
  dalian: 'CN', haikou: 'CN', macau: 'CN', zhanjiang: 'CN', quanzhou: 'CN',
  port_of_ningbo_zhoushan: 'CN', port_of_shenzhen: 'CN', port_of_guangzhou: 'CN',
  inchon: 'KR', pusan: 'KR', port_of_nagoya: 'JP', osaka: 'JP', wakamatsu: 'JP',
  nagasaki: 'JP', niigata: 'JP', tokyo: 'JP', port_of_sendai: 'JP', ishikari: 'JP', hiroshima: 'JP',
  king_abdullah_port: 'SA', jeddah: 'SA', jubail: 'SA', damman: 'SA',
  colombo: 'LK', karachi: 'PK', port_of_shahid_rajaee: 'IR',
  shuaiba: 'KW', al_hidd: 'BH', mesaieed: 'QA', ras_laffan: 'QA',
  aden: 'YE', al_hudaydah: 'YE', salalah: 'OM', sohar: 'OM',
  yangon: 'MM', chattogram: 'BD', mongla: 'BD',
  hai_phong: 'VN', da_nang: 'VN', ho_chi_minh_city: 'VN', sihanoukville: 'KH', nampo: 'KP',
  dili: 'TL', port_of_easter_island: 'CL', port_of_manaus: 'BR'
};

/**
 * Format route display like "DE HAM &lt;> NL RTM"
 * @param {string} routeStr - Route string like "hamburg&lt;>rotterdam"
 * @returns {string} Formatted route display
 */
function formatRouteDisplay(routeStr) {
  if (!routeStr) return '-';
  const parts = routeStr.split('&lt;>');
  if (parts.length !== 2) return routeStr;

  const [origin, destination] = parts;
  const originCountry = PORT_COUNTRIES[origin] || '??';
  const destCountry = PORT_COUNTRIES[destination] || '??';
  const originAbbr = formatPortAbbreviation(origin);
  const destAbbr = formatPortAbbreviation(destination);

  return `${originCountry} ${originAbbr} &lt;> ${destCountry} ${destAbbr}`;
}

/**
 * Normalize route key to canonical form (alphabetically sorted)
 * This ensures A&lt;>B and B&lt;>A are treated as the same route
 * @param {string} origin - Origin port
 * @param {string} destination - Destination port
 * @returns {string} Normalized route key
 */
function normalizeRouteKey(origin, destination) {
  const [first, second] = [origin, destination].sort();
  return `${first}&lt;>${second}`;
}

// Use AppData when packaged as exe
const isPkg = !!process.pkg;

// Initialize hijack history directory (for fallback vessel_name lookup)
HIJACK_HISTORY_DIR = isPkg
  ? path.join(getAppBaseDir(), 'userdata', 'hijack_history')
  : path.join(__dirname, '../../userdata/hijack_history');

/**
 * Get audit log file path for a user
 * @param {string} userId - User ID
 * @returns {string} File path
 */
function getAuditLogPath(userId) {
  const logDir = path.join(getLogDir(), 'autopilot');
  return path.join(logDir, `${userId}-autopilot-log.json`);
}

/**
 * Get trip data file path for a user
 * @param {string} userId - User ID
 * @returns {string} File path
 */
function getTripDataPath(userId) {
  const tripDataDir = isPkg
    ? path.join(getAppBaseDir(), 'userdata', 'trip-data')
    : path.join(__dirname, '../../userdata/trip-data');
  return path.join(tripDataDir, `trip-data-${userId}.json`);
}

/**
 * Load audit log for a user (cached for 2 seconds to avoid duplicate reads)
 * @param {string} userId - User ID
 * @returns {Promise&lt;Array>} Array of log entries
 */
async function loadAuditLog(userId) {
  const cacheKey = `auditLog-${userId}`;
  const now = Date.now();
  const cached = fileCache.get(cacheKey);

  if (cached &amp;&amp; (now - cached.timestamp) &lt; FILE_CACHE_TTL) {
    return cached.data;
  }

  try {
    const filePath = getAuditLogPath(userId);
    const data = await fs.readFile(filePath, 'utf8');
    const parsed = JSON.parse(data);
    fileCache.set(cacheKey, { data: parsed, timestamp: now });
    return parsed;
  } catch (error) {
    if (error.code === 'ENOENT') {
      fileCache.set(cacheKey, { data: [], timestamp: now });
      return [];
    }
    logger.error(`[Analytics] Failed to load audit log for user ${userId}:`, error.message);
    return [];
  }
}

/**
 * Load trip data for a user (cached for 2 seconds to avoid duplicate reads)
 * @param {string} userId - User ID
 * @returns {Promise&lt;Object>} Trip data map
 */
async function loadTripData(userId) {
  const cacheKey = `tripData-${userId}`;
  const now = Date.now();
  const cached = fileCache.get(cacheKey);

  if (cached &amp;&amp; (now - cached.timestamp) &lt; FILE_CACHE_TTL) {
    return cached.data;
  }

  try {
    const filePath = getTripDataPath(userId);
    const data = await fs.readFile(filePath, 'utf8');
    const parsed = JSON.parse(data);
    fileCache.set(cacheKey, { data: parsed, timestamp: now });
    return parsed;
  } catch (error) {
    if (error.code === 'ENOENT') {
      fileCache.set(cacheKey, { data: {}, timestamp: now });
      return {};
    }
    logger.error(`[Analytics] Failed to load trip data for user ${userId}:`, error.message);
    return {};
  }
}

/**
 * Filter log entries by time range
 * @param {Array} logs - Log entries
 * @param {number} days - Number of days to include
 * @returns {Array} Filtered entries
 */
function filterByDays(logs, days) {
  // days === 0 means "all time" - no filtering
  if (days === 0) return logs;
  const cutoff = Date.now() - (days * 24 * 60 * 60 * 1000);
  return logs.filter(log => log.timestamp >= cutoff);
}

/**
 * Filter log entries by autopilot type
 * @param {Array} logs - Log entries
 * @param {string|Array} types - Autopilot type(s) to filter
 * @returns {Array} Filtered entries
 */
function filterByType(logs, types) {
  const typeArray = Array.isArray(types) ? types : [types];
  return logs.filter(log => typeArray.includes(log.autopilot));
}

/**
 * Calculate weighted average price from purchase logs
 * @param {Array} purchases - Purchase log entries
 * @returns {number} Weighted average price
 */
function calculateWeightedAverage(purchases) {
  if (!purchases.length) return 0;

  let totalAmount = 0;
  let totalCost = 0;

  purchases.forEach(p => {
    const amount = p.details?.amount || 0;
    const cost = p.details?.totalCost || 0;
    totalAmount += amount;
    totalCost += cost;
  });

  return totalAmount > 0 ? totalCost / totalAmount : 0;
}

/**
 * Get weekly summary for a user
 * @param {string} userId - User ID
 * @param {number} weeks - Number of weeks (default 1)
 * @returns {Promise&lt;Object>} Weekly summary
 */
async function getWeeklySummary(userId, weeks = 1) {
  const logs = await loadAuditLog(userId);
  const days = weeks * 7;
  const filtered = filterByDays(logs, days);

  // Departures
  const departures = filterByType(filtered, ['Auto-Depart', 'Manual Depart']);
  let totalRevenue = 0;
  let totalTrips = 0;
  let totalFuelUsed = 0;
  let totalCO2Used = 0;
  let totalHarborFees = 0;
  let totalContribution = 0;

  departures.forEach(log => {
    if (log.status === 'SUCCESS') {
      totalRevenue += log.details?.totalRevenue || 0;
      totalTrips += log.details?.vesselCount || 0;
      totalFuelUsed += log.details?.totalFuelUsed || 0;
      totalCO2Used += log.details?.totalCO2Used || 0;
      totalHarborFees += log.details?.totalHarborFees || 0;
      totalContribution += log.details?.contributionGainedTotal || 0;
    }
  });

  // Fuel purchases
  const fuelPurchases = filterByType(filtered, ['Auto-Fuel', 'Manual Fuel Purchase']);
  let fuelCost = 0;
  let fuelPurchased = 0;
  fuelPurchases.forEach(log => {
    if (log.status === 'SUCCESS') {
      fuelCost += log.details?.totalCost || 0;
      fuelPurchased += log.details?.amount || 0;
    }
  });

  // CO2 purchases
  const co2Purchases = filterByType(filtered, ['Auto-CO2', 'Manual CO2 Purchase']);
  let co2Cost = 0;
  let co2Purchased = 0;
  co2Purchases.forEach(log => {
    if (log.status === 'SUCCESS') {
      co2Cost += log.details?.totalCost || 0;
      co2Purchased += log.details?.amount || 0;
    }
  });

  // Repairs
  const repairs = filterByType(filtered, ['Auto-Repair', 'Auto-Drydock', 'Manual Repair', 'Manual Drydock']);
  let repairCost = 0;
  let repairCount = 0;
  repairs.forEach(log => {
    if (log.status === 'SUCCESS') {
      repairCost += log.details?.totalCost || log.details?.cost || 0;
      repairCount += log.details?.vesselCount || 1;
    }
  });

  // Marketing
  const marketing = filterByType(filtered, ['Auto-Marketing', 'Auto-Reputation', 'Manual Marketing']);
  let marketingCost = 0;
  marketing.forEach(log => {
    if (log.status === 'SUCCESS') {
      marketingCost += log.details?.totalCost || log.details?.cost || 0;
    }
  });

  // Stock transactions
  const stocks = filterByType(filtered, ['Manual Stock Purchase', 'Manual Stock Sale']);
  let stockPurchases = 0;
  let stockSales = 0;
  stocks.forEach(log => {
    if (log.status === 'SUCCESS') {
      if (log.autopilot.includes('Purchase')) {
        stockPurchases += log.details?.total_cost || 0;
      } else {
        stockSales += log.details?.total_revenue || 0;
      }
    }
  });

  // Calculate totals
  const totalExpenses = fuelCost + co2Cost + repairCost + marketingCost + totalHarborFees + stockPurchases;
  const totalIncome = totalRevenue + stockSales;
  const netProfit = totalIncome - totalExpenses;
  const profitMargin = totalIncome > 0 ? (netProfit / totalIncome) * 100 : 0;

  // Calculate averages
  const avgFuelPrice = calculateWeightedAverage(fuelPurchases.filter(p => p.status === 'SUCCESS'));
  const avgCO2Price = calculateWeightedAverage(co2Purchases.filter(p => p.status === 'SUCCESS'));

  return {
    period: {
      days,
      weeks,
      from: Date.now() - (days * 24 * 60 * 60 * 1000),
      to: Date.now()
    },
    income: {
      total: totalIncome,
      revenue: totalRevenue,
      stockSales
    },
    expenses: {
      total: totalExpenses,
      fuel: fuelCost,
      co2: co2Cost,
      repairs: repairCost,
      marketing: marketingCost,
      harborFees: totalHarborFees,
      stockPurchases
    },
    profit: {
      net: netProfit,
      margin: profitMargin
    },
    operations: {
      trips: totalTrips,
      fuelUsed: totalFuelUsed,
      co2Used: totalCO2Used,
      fuelPurchased,
      co2Purchased,
      repairCount,
      contribution: totalContribution
    },
    averages: {
      fuelPrice: avgFuelPrice,
      co2Price: avgCO2Price,
      revenuePerTrip: totalTrips > 0 ? totalRevenue / totalTrips : 0
    }
  };
}

/**
 * Get vessel performance metrics
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze (default 30)
 * @returns {Promise&lt;Array>} Vessel performance data
 */
async function getVesselPerformance(userId, days = 30) {
  const logs = await loadAuditLog(userId);
  const filtered = filterByDays(logs, days);
  const departures = filterByType(filtered, ['Auto-Depart', 'Manual Depart']);

  // Aggregate by vessel
  const vesselMap = new Map();

  departures.forEach(log => {
    if (log.status !== 'SUCCESS') return;

    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    vessels.forEach(v => {
      const id = v.vesselId || v.vessel_id;
      if (!id) return;

      if (!vesselMap.has(id)) {
        vesselMap.set(id, {
          vesselId: id,
          name: v.name || v.vesselName || `Vessel ${id}`,
          trips: 0,
          totalRevenue: 0,
          totalFuelUsed: 0,
          totalCO2Used: 0,
          totalHarborFees: 0,
          totalContribution: 0,
          totalDistance: 0,
          utilizationSum: 0,
          routes: new Map()
        });
      }

      const vessel = vesselMap.get(id);
      vessel.trips++;
      vessel.totalRevenue += v.income || 0;
      vessel.totalFuelUsed += v.fuelUsed || 0;
      vessel.totalCO2Used += v.co2Used || 0;
      vessel.totalHarborFees += Math.abs(v.harborFee || 0);
      vessel.totalContribution += v.contributionGained || 0;
      vessel.totalDistance += v.distance || 0;
      vessel.utilizationSum += v.utilization || 0;

      // Track routes
      const routeKey = `${v.origin}&lt;>${v.destination}`;
      if (v.origin &amp;&amp; v.destination) {
        const current = vessel.routes.get(routeKey);
        vessel.routes.set(routeKey, current ? current + 1 : 1);
      }
    });
  });

  // Calculate averages and convert to array
  const results = [];
  vesselMap.forEach((vessel, id) => {
    const avgUtilization = vessel.trips > 0 ? vessel.utilizationSum / vessel.trips : 0;
    const avgRevenuePerTrip = vessel.trips > 0 ? vessel.totalRevenue / vessel.trips : 0;
    const fuelEfficiency = vessel.totalFuelUsed > 0 ? vessel.totalDistance / vessel.totalFuelUsed : 0;

    // Find most used route
    let primaryRoute = null;
    let maxRouteTrips = 0;
    vessel.routes.forEach((count, route) => {
      if (count > maxRouteTrips) {
        maxRouteTrips = count;
        primaryRoute = route;
      }
    });

    results.push({
      vesselId: id,
      name: vessel.name,
      trips: vessel.trips,
      totalRevenue: vessel.totalRevenue,
      totalFuelUsed: vessel.totalFuelUsed,
      totalCO2Used: vessel.totalCO2Used,
      totalHarborFees: vessel.totalHarborFees,
      totalContribution: vessel.totalContribution,
      totalDistance: vessel.totalDistance,
      avgUtilization: avgUtilization * 100,
      avgRevenuePerTrip,
      fuelEfficiency,
      primaryRoute: formatRouteDisplay(primaryRoute),
      routeCount: vessel.routes.size
    });
  });

  // Sort by revenue descending
  results.sort((a, b) => b.totalRevenue - a.totalRevenue);

  return results;
}

/**
 * Get route profitability analysis
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze (default 30)
 * @returns {Promise&lt;Array>} Route profitability data
 */
async function getRouteProfitability(userId, days = 30) {
  const logs = await loadAuditLog(userId);
  const filtered = filterByDays(logs, days);
  const departures = filterByType(filtered, ['Auto-Depart', 'Manual Depart']);

  // Aggregate by route
  const routeMap = new Map();

  departures.forEach(log => {
    if (log.status !== 'SUCCESS') return;

    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    vessels.forEach(v => {
      const origin = v.origin || '';
      const destination = v.destination || '';
      if (!origin || !destination) return;

      const routeKey = `${origin}&lt;>${destination}`;

      if (!routeMap.has(routeKey)) {
        routeMap.set(routeKey, {
          route: routeKey,
          origin,
          destination,
          trips: 0,
          totalRevenue: 0,
          totalHarborFees: 0,
          totalFuelUsed: 0,
          totalDistance: 0,
          vessels: new Set()
        });
      }

      const route = routeMap.get(routeKey);
      route.trips++;
      route.totalRevenue += v.income || 0;
      route.totalHarborFees += Math.abs(v.harborFee || 0);
      route.totalFuelUsed += v.fuelUsed || 0;
      route.totalDistance += v.distance || 0;
      route.vessels.add(v.vesselId || v.vessel_id);
    });
  });

  // Calculate metrics and convert to array
  const results = [];
  routeMap.forEach((route) => {
    const avgRevenuePerTrip = route.trips > 0 ? route.totalRevenue / route.trips : 0;
    const avgHarborFee = route.trips > 0 ? route.totalHarborFees / route.trips : 0;
    const harborFeePercent = route.totalRevenue > 0 ? (route.totalHarborFees / route.totalRevenue) * 100 : 0;
    // Distance is in nautical miles
    const avgIncomePerNm = route.totalDistance > 0 ? route.totalRevenue / route.totalDistance : 0;

    results.push({
      route: route.route,
      origin: route.origin,
      destination: route.destination,
      trips: route.trips,
      totalRevenue: route.totalRevenue,
      totalHarborFees: route.totalHarborFees,
      totalFuelUsed: route.totalFuelUsed,
      totalDistance: route.totalDistance,
      avgRevenuePerTrip,
      avgHarborFee,
      harborFeePercent,
      avgIncomePerNm,
      vesselCount: route.vessels.size
    });
  });

  // Sort by total revenue descending
  results.sort((a, b) => b.totalRevenue - a.totalRevenue);

  return results;
}

/**
 * Get fuel and CO2 purchase analysis
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze (default 30)
 * @returns {Promise&lt;Object>} Purchase analysis
 */
async function getPurchaseAnalysis(userId, days = 30) {
  const logs = await loadAuditLog(userId);
  const filtered = filterByDays(logs, days);

  // Fuel purchases
  const fuelPurchases = filterByType(filtered, ['Auto-Fuel', 'Manual Fuel Purchase'])
    .filter(log => log.status === 'SUCCESS');

  const fuelAnalysis = {
    totalPurchases: fuelPurchases.length,
    totalAmount: 0,
    totalCost: 0,
    avgPrice: 0,
    minPrice: Infinity,
    maxPrice: 0,
    priceHistory: []
  };

  fuelPurchases.forEach(log => {
    const amount = log.details?.amount || 0;
    const price = log.details?.price || 0;
    const cost = log.details?.totalCost || 0;

    fuelAnalysis.totalAmount += amount;
    fuelAnalysis.totalCost += cost;
    if (price > 0) {
      fuelAnalysis.minPrice = Math.min(fuelAnalysis.minPrice, price);
      fuelAnalysis.maxPrice = Math.max(fuelAnalysis.maxPrice, price);
      fuelAnalysis.priceHistory.push({
        timestamp: log.timestamp,
        price,
        amount
      });
    }
  });

  fuelAnalysis.avgPrice = fuelAnalysis.totalAmount > 0
    ? fuelAnalysis.totalCost / fuelAnalysis.totalAmount
    : 0;
  if (fuelAnalysis.minPrice === Infinity) fuelAnalysis.minPrice = 0;

  // CO2 purchases
  const co2Purchases = filterByType(filtered, ['Auto-CO2', 'Manual CO2 Purchase'])
    .filter(log => log.status === 'SUCCESS');

  const co2Analysis = {
    totalPurchases: co2Purchases.length,
    totalAmount: 0,
    totalCost: 0,
    avgPrice: 0,
    minPrice: Infinity,
    maxPrice: 0,
    priceHistory: []
  };

  co2Purchases.forEach(log => {
    const amount = log.details?.amount || 0;
    const price = log.details?.price || 0;
    const cost = log.details?.totalCost || 0;

    co2Analysis.totalAmount += amount;
    co2Analysis.totalCost += cost;
    if (price > 0) {
      co2Analysis.minPrice = Math.min(co2Analysis.minPrice, price);
      co2Analysis.maxPrice = Math.max(co2Analysis.maxPrice, price);
      co2Analysis.priceHistory.push({
        timestamp: log.timestamp,
        price,
        amount
      });
    }
  });

  co2Analysis.avgPrice = co2Analysis.totalAmount > 0
    ? co2Analysis.totalCost / co2Analysis.totalAmount
    : 0;
  if (co2Analysis.minPrice === Infinity) co2Analysis.minPrice = 0;

  return {
    fuel: fuelAnalysis,
    co2: co2Analysis
  };
}

/**
 * Get harbor fee analysis by destination
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze (default 30)
 * @returns {Promise&lt;Array>} Harbor fee analysis by port
 */
async function getHarborFeeAnalysis(userId, days = 30) {
  const logs = await loadAuditLog(userId);
  const filtered = filterByDays(logs, days);
  const departures = filterByType(filtered, ['Auto-Depart', 'Manual Depart']);

  // Aggregate by destination
  const portMap = new Map();

  departures.forEach(log => {
    if (log.status !== 'SUCCESS') return;

    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    vessels.forEach(v => {
      const destination = v.destination || '';
      if (!destination) return;

      if (!portMap.has(destination)) {
        portMap.set(destination, {
          port: destination,
          trips: 0,
          totalFees: 0,
          totalRevenue: 0
        });
      }

      const port = portMap.get(destination);
      port.trips++;
      port.totalFees += Math.abs(v.harborFee || 0);
      port.totalRevenue += v.income || 0;
    });
  });

  // Calculate metrics and convert to array
  const results = [];
  portMap.forEach((port) => {
    const avgFee = port.trips > 0 ? port.totalFees / port.trips : 0;
    const feePercent = port.totalRevenue > 0 ? (port.totalFees / port.totalRevenue) * 100 : 0;

    results.push({
      port: port.port,
      trips: port.trips,
      totalFees: port.totalFees,
      totalRevenue: port.totalRevenue,
      avgFee,
      feePercent
    });
  });

  // Sort by total fees descending
  results.sort((a, b) => b.totalFees - a.totalFees);

  return results;
}

/**
 * Get contribution analysis
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze (default 30)
 * @returns {Promise&lt;Object>} Contribution analysis
 */
async function getContributionAnalysis(userId, days = 30) {
  const logs = await loadAuditLog(userId);
  const filtered = filterByDays(logs, days);
  const departures = filterByType(filtered, ['Auto-Depart', 'Manual Depart']);

  let totalContribution = 0;
  let totalTrips = 0;
  let totalRevenue = 0;
  const vesselContribution = new Map();

  departures.forEach(log => {
    if (log.status !== 'SUCCESS') return;

    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    vessels.forEach(v => {
      const id = v.vesselId || v.vessel_id;
      const contribution = v.contributionGained || 0;
      const revenue = v.income || 0;

      totalContribution += contribution;
      totalTrips++;
      totalRevenue += revenue;

      if (id) {
        if (!vesselContribution.has(id)) {
          vesselContribution.set(id, {
            vesselId: id,
            name: v.name || v.vesselName || `Vessel ${id}`,
            trips: 0,
            totalContribution: 0,
            totalRevenue: 0
          });
        }

        const vessel = vesselContribution.get(id);
        vessel.trips++;
        vessel.totalContribution += contribution;
        vessel.totalRevenue += revenue;
      }
    });
  });

  // Convert to array and sort
  const byVessel = [];
  vesselContribution.forEach((vessel) => {
    const avgPerTrip = vessel.trips > 0 ? vessel.totalContribution / vessel.trips : 0;
    const efficiency = vessel.totalRevenue > 0 ? vessel.totalContribution / (vessel.totalRevenue / 1000000) : 0;

    byVessel.push({
      ...vessel,
      avgPerTrip,
      efficiency
    });
  });

  byVessel.sort((a, b) => b.totalContribution - a.totalContribution);

  return {
    total: totalContribution,
    trips: totalTrips,
    avgPerTrip: totalTrips > 0 ? totalContribution / totalTrips : 0,
    efficiency: totalRevenue > 0 ? totalContribution / (totalRevenue / 1000000) : 0,
    byVessel
  };
}

/**
 * Get daily revenue trend
 * @param {string} userId - User ID
 * @param {number} days - Number of days (default 30)
 * @returns {Promise&lt;Array>} Daily revenue data
 */
async function getDailyRevenueTrend(userId, days = 30) {
  const logs = await loadAuditLog(userId);
  const filtered = filterByDays(logs, days);
  const departures = filterByType(filtered, ['Auto-Depart', 'Manual Depart']);

  // Group by day
  const dailyMap = new Map();

  departures.forEach(log => {
    if (log.status !== 'SUCCESS') return;

    const date = new Date(log.timestamp);
    const dayKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;

    if (!dailyMap.has(dayKey)) {
      dailyMap.set(dayKey, {
        date: dayKey,
        timestamp: new Date(dayKey).getTime(),
        revenue: 0,
        trips: 0,
        expenses: 0
      });
    }

    const day = dailyMap.get(dayKey);
    day.revenue += log.details?.totalRevenue || 0;
    day.trips += log.details?.vesselCount || 0;
  });

  // Add expense data
  const expenses = filterByType(filtered, ['Auto-Fuel', 'Auto-CO2', 'Auto-Repair', 'Auto-Drydock', 'Manual Fuel Purchase', 'Manual CO2 Purchase']);
  expenses.forEach(log => {
    if (log.status !== 'SUCCESS') return;

    const date = new Date(log.timestamp);
    const dayKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;

    if (!dailyMap.has(dayKey)) {
      dailyMap.set(dayKey, {
        date: dayKey,
        timestamp: new Date(dayKey).getTime(),
        revenue: 0,
        trips: 0,
        expenses: 0
      });
    }

    const day = dailyMap.get(dayKey);
    day.expenses += log.details?.totalCost || log.details?.cost || 0;
  });

  // Convert to array and sort by date
  const results = Array.from(dailyMap.values());
  results.sort((a, b) => a.timestamp - b.timestamp);

  // Calculate profit for each day
  results.forEach(day => {
    day.profit = day.revenue - day.expenses;
  });

  return results;
}

/**
 * Get route contribution analysis
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze (default 30)
 * @returns {Promise&lt;Array>} Route contribution data
 */
async function getRouteContribution(userId, days = 30) {
  const logs = await loadAuditLog(userId);
  const filtered = filterByDays(logs, days);
  const departures = filterByType(filtered, ['Auto-Depart', 'Manual Depart']);

  // Aggregate by route
  const routeMap = new Map();

  departures.forEach(log => {
    if (log.status !== 'SUCCESS') return;

    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    vessels.forEach(v => {
      const origin = v.origin || '';
      const destination = v.destination || '';
      if (!origin || !destination) return;

      const routeKey = `${origin}&lt;>${destination}`;

      if (!routeMap.has(routeKey)) {
        routeMap.set(routeKey, {
          route: routeKey,
          origin,
          destination,
          trips: 0,
          totalContribution: 0,
          totalRevenue: 0,
          totalDistance: 0,
          vessels: new Set()
        });
      }

      const route = routeMap.get(routeKey);
      route.trips++;
      route.totalContribution += v.contributionGained || 0;
      route.totalRevenue += v.income || 0;
      route.totalDistance += v.distance || 0;
      route.vessels.add(v.vesselId || v.vessel_id);
    });
  });

  // Calculate metrics and convert to array
  const results = [];
  routeMap.forEach((route) => {
    const avgContribPerTrip = route.trips > 0 ? route.totalContribution / route.trips : 0;
    const contribPerKm = route.totalDistance > 0 ? route.totalContribution / (route.totalDistance / 1000) : 0;
    const contribPer100kRevenue = route.totalRevenue > 0 ? (route.totalContribution / route.totalRevenue) * 100000 : 0;

    results.push({
      route: route.route,
      origin: route.origin,
      destination: route.destination,
      trips: route.trips,
      totalContribution: route.totalContribution,
      totalRevenue: route.totalRevenue,
      totalDistance: route.totalDistance,
      avgContribPerTrip,
      contribPerKm,
      contribPer100kRevenue,
      vesselCount: route.vessels.size
    });
  });

  // Sort by total contribution descending
  results.sort((a, b) => b.totalContribution - a.totalContribution);

  return results;
}

/**
 * Get detailed expense breakdown (all log categories)
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze
 * @returns {Promise&lt;Object>} Detailed expense breakdown
 */
async function getDetailedExpenses(userId, days = 30) {
  const logs = await loadAuditLog(userId);
  const filtered = filterByDays(logs, days);

  const expenses = {
    fuel: { total: 0, count: 0, auto: 0, manual: 0, entries: [] },
    co2: { total: 0, count: 0, auto: 0, manual: 0, entries: [] },
    repairs: { total: 0, count: 0, auto: 0, manual: 0, entries: [] },
    drydock: { total: 0, count: 0, auto: 0, manual: 0, entries: [] },
    campaigns: { total: 0, count: 0, auto: 0, manual: 0, entries: [] },
    anchors: { total: 0, count: 0, auto: 0, manual: 0, entries: [] },
    harborFees: { total: 0, count: 0, entries: [] },
    hijacking: { ransomPaid: 0, negotiated: 0, count: 0, entries: [] },
    vesselPurchases: { total: 0, count: 0, entries: [] },
    vesselSales: { total: 0, count: 0, entries: [] },
    // Game-log only categories (merged from getMergedSummary)
    salary: { total: 0, count: 0, auto: 0, manual: 0 },
    guards: { total: 0, count: 0, auto: 0, manual: 0 },
    routeFees: { total: 0, count: 0, auto: 0, manual: 0 },
    pirateRaid: { total: 0, count: 0, auto: 0, manual: 0 },
    stockPurchases: { total: 0, count: 0, auto: 0, manual: 0 },
    allianceContribution: { total: 0, count: 0, auto: 0, manual: 0 },
    vesselBuilding: { total: 0, count: 0, auto: 0, manual: 0 }
  };

  // Fuel
  filterByType(filtered, ['Auto-Fuel']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.fuel.total += log.details?.totalCost || 0;
      expenses.fuel.auto += log.details?.totalCost || 0;
      expenses.fuel.count++;
      expenses.fuel.entries.push({ timestamp: log.timestamp, amount: log.details?.amount, price: log.details?.price, cost: log.details?.totalCost, source: 'auto' });
    }
  });
  filterByType(filtered, ['Manual Fuel Purchase']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.fuel.total += log.details?.totalCost || 0;
      expenses.fuel.manual += log.details?.totalCost || 0;
      expenses.fuel.count++;
      expenses.fuel.entries.push({ timestamp: log.timestamp, amount: log.details?.amount, price: log.details?.price, cost: log.details?.totalCost, source: 'manual' });
    }
  });

  // CO2
  filterByType(filtered, ['Auto-CO2']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.co2.total += log.details?.totalCost || 0;
      expenses.co2.auto += log.details?.totalCost || 0;
      expenses.co2.count++;
      expenses.co2.entries.push({ timestamp: log.timestamp, amount: log.details?.amount, price: log.details?.price, cost: log.details?.totalCost, source: 'auto' });
    }
  });
  filterByType(filtered, ['Manual CO2 Purchase']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.co2.total += log.details?.totalCost || 0;
      expenses.co2.manual += log.details?.totalCost || 0;
      expenses.co2.count++;
      expenses.co2.entries.push({ timestamp: log.timestamp, amount: log.details?.amount, price: log.details?.price, cost: log.details?.totalCost, source: 'manual' });
    }
  });

  // Repairs
  filterByType(filtered, ['Auto-Repair']).forEach(log => {
    if (log.status === 'SUCCESS') {
      const cost = log.details?.totalCost || log.details?.cost || 0;
      expenses.repairs.total += cost;
      expenses.repairs.auto += cost;
      expenses.repairs.count += log.details?.vesselCount || 1;
      expenses.repairs.entries.push({ timestamp: log.timestamp, cost, vesselCount: log.details?.vesselCount || 1, source: 'auto' });
    }
  });
  filterByType(filtered, ['Manual Bulk Repair']).forEach(log => {
    if (log.status === 'SUCCESS') {
      const cost = log.details?.totalCost || log.details?.cost || 0;
      expenses.repairs.total += cost;
      expenses.repairs.manual += cost;
      expenses.repairs.count += log.details?.vesselCount || 1;
      expenses.repairs.entries.push({ timestamp: log.timestamp, cost, vesselCount: log.details?.vesselCount || 1, source: 'manual' });
    }
  });

  // Drydock
  filterByType(filtered, ['Auto-Drydock']).forEach(log => {
    if (log.status === 'SUCCESS') {
      const cost = log.details?.totalCost || log.details?.cost || 0;
      expenses.drydock.total += cost;
      expenses.drydock.auto += cost;
      expenses.drydock.count += log.details?.vesselCount || 1;
      expenses.drydock.entries.push({ timestamp: log.timestamp, cost, source: 'auto' });
    }
  });
  filterByType(filtered, ['Manual Bulk Drydock']).forEach(log => {
    if (log.status === 'SUCCESS') {
      const cost = log.details?.totalCost || log.details?.cost || 0;
      expenses.drydock.total += cost;
      expenses.drydock.manual += cost;
      expenses.drydock.count += log.details?.vesselCount || 1;
      expenses.drydock.entries.push({ timestamp: log.timestamp, cost, source: 'manual' });
    }
  });

  // Campaigns
  filterByType(filtered, ['Auto-Campaign']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.campaigns.total += log.details?.totalCost || 0;
      expenses.campaigns.auto += log.details?.totalCost || 0;
      expenses.campaigns.count += log.details?.campaignCount || 1;
      expenses.campaigns.entries.push({ timestamp: log.timestamp, cost: log.details?.totalCost, campaigns: log.details?.renewedCampaigns, source: 'auto' });
    }
  });
  filterByType(filtered, ['Campaign Activation']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.campaigns.total += log.details?.totalCost || log.details?.cost || 0;
      expenses.campaigns.manual += log.details?.totalCost || log.details?.cost || 0;
      expenses.campaigns.count++;
      expenses.campaigns.entries.push({ timestamp: log.timestamp, cost: log.details?.totalCost || log.details?.cost, source: 'manual' });
    }
  });

  // Anchors
  filterByType(filtered, ['Auto-Anchor']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.anchors.total += log.details?.totalCost || 0;
      expenses.anchors.auto += log.details?.totalCost || 0;
      expenses.anchors.count += log.details?.amount || 1;
      expenses.anchors.entries.push({ timestamp: log.timestamp, cost: log.details?.totalCost, amount: log.details?.amount, source: 'auto' });
    }
  });
  filterByType(filtered, ['Manual Anchor Purchase']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.anchors.total += log.details?.totalCost || 0;
      expenses.anchors.manual += log.details?.totalCost || 0;
      expenses.anchors.count += log.details?.amount || 1;
      expenses.anchors.entries.push({ timestamp: log.timestamp, cost: log.details?.totalCost, amount: log.details?.amount, source: 'manual' });
    }
  });

  // Harbor fees from departures
  filterByType(filtered, ['Auto-Depart', 'Manual Depart']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.harborFees.total += log.details?.totalHarborFees || 0;
      expenses.harborFees.count += log.details?.vesselCount || 0;
    }
  });

  // Hijacking
  filterByType(filtered, ['Manual Pay Ransom']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.hijacking.ransomPaid += log.details?.amount || log.details?.cost || 0;
      expenses.hijacking.count++;
      expenses.hijacking.entries.push({ timestamp: log.timestamp, type: 'ransom', amount: log.details?.amount || log.details?.cost });
    }
  });
  filterByType(filtered, ['Manual Negotiate Hijacking']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.hijacking.negotiated++;
      expenses.hijacking.entries.push({ timestamp: log.timestamp, type: 'negotiate' });
    }
  });

  // Vessel purchases
  filterByType(filtered, ['Manual Vessel Purchase']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.vesselPurchases.total += log.details?.total_cost || 0;
      expenses.vesselPurchases.count += log.details?.vessel_count || 1;
      expenses.vesselPurchases.entries.push({ timestamp: log.timestamp, cost: log.details?.total_cost, vessels: log.details?.vessels });
    }
  });

  // Vessel sales
  filterByType(filtered, ['Manual Vessel Sale']).forEach(log => {
    if (log.status === 'SUCCESS') {
      expenses.vesselSales.total += log.details?.total_revenue || log.details?.revenue || 0;
      expenses.vesselSales.count += log.details?.vessel_count || 1;
      expenses.vesselSales.entries.push({ timestamp: log.timestamp, revenue: log.details?.total_revenue || log.details?.revenue });
    }
  });

  // Merge game-log data - this is the authoritative source for totals
  // getMergedSummary now returns expenses with auto/manual breakdown for certain categories
  let gameGrandTotal = 0;
  try {
    const mergedSummary = await getMergedSummary(userId, days);
    if (mergedSummary &amp;&amp; mergedSummary.expenses) {
      const gameExp = mergedSummary.expenses;

      // Helper to extract value from either number or {total, auto, manual} object
      const getValue = (val, prop = 'total') => {
        if (typeof val === 'number') return val;
        if (val &amp;&amp; typeof val === 'object') return val[prop] || 0;
        return 0;
      };

      // Use game-log grand total as authoritative (same as Game Log tab)
      gameGrandTotal = gameExp.total || 0;

      // Merge game-log only categories (these don't have auto/manual from game log)
      expenses.salary.total = getValue(gameExp.salary);
      expenses.salary.auto = getValue(gameExp.salary);
      expenses.guards.total = getValue(gameExp.guards);
      expenses.guards.auto = getValue(gameExp.guards);
      expenses.routeFees.total = getValue(gameExp.routeFees);
      expenses.routeFees.auto = getValue(gameExp.routeFees);
      expenses.pirateRaid.total = getValue(gameExp.pirateRaid);
      expenses.pirateRaid.manual = getValue(gameExp.pirateRaid);
      expenses.stockPurchases.total = getValue(gameExp.stockPurchases);
      expenses.stockPurchases.manual = getValue(gameExp.stockPurchases);
      expenses.allianceContribution.total = getValue(gameExp.allianceContribution);
      expenses.allianceContribution.manual = getValue(gameExp.allianceContribution);
      expenses.vesselBuilding.total = getValue(gameExp.vesselBuilding);
      expenses.vesselBuilding.manual = getValue(gameExp.vesselBuilding);

      // Categories with auto/manual breakdown from getMergedSummary
      // Use the merged totals AND the auto/manual breakdown
      if (gameExp.fuel) {
        expenses.fuel.total = getValue(gameExp.fuel) || expenses.fuel.total;
        expenses.fuel.auto = getValue(gameExp.fuel, 'auto') || expenses.fuel.auto;
        expenses.fuel.manual = getValue(gameExp.fuel, 'manual') || expenses.fuel.manual;
      }
      if (gameExp.co2) {
        expenses.co2.total = getValue(gameExp.co2) || expenses.co2.total;
        expenses.co2.auto = getValue(gameExp.co2, 'auto') || expenses.co2.auto;
        expenses.co2.manual = getValue(gameExp.co2, 'manual') || expenses.co2.manual;
      }
      if (gameExp.repairs) {
        expenses.repairs.total = getValue(gameExp.repairs) || expenses.repairs.total;
        expenses.repairs.auto = getValue(gameExp.repairs, 'auto') || expenses.repairs.auto;
        expenses.repairs.manual = getValue(gameExp.repairs, 'manual') || expenses.repairs.manual;
      }
      if (gameExp.drydock) {
        expenses.drydock.total = getValue(gameExp.drydock) || expenses.drydock.total;
        expenses.drydock.auto = getValue(gameExp.drydock, 'auto') || expenses.drydock.auto;
        expenses.drydock.manual = getValue(gameExp.drydock, 'manual') || expenses.drydock.manual;
      }
      if (gameExp.marketing) {
        expenses.campaigns.total = getValue(gameExp.marketing) || expenses.campaigns.total;
        expenses.campaigns.auto = getValue(gameExp.marketing, 'auto') || expenses.campaigns.auto;
        expenses.campaigns.manual = getValue(gameExp.marketing, 'manual') || expenses.campaigns.manual;
      }
      if (gameExp.anchors) {
        expenses.anchors.total = getValue(gameExp.anchors) || expenses.anchors.total;
        expenses.anchors.auto = getValue(gameExp.anchors, 'auto') || expenses.anchors.auto;
        expenses.anchors.manual = getValue(gameExp.anchors, 'manual') || expenses.anchors.manual;
      }

      // Simple categories without auto/manual
      expenses.harborFees.total = getValue(gameExp.harborFees) || expenses.harborFees.total;
      expenses.hijacking.ransomPaid = getValue(gameExp.hijacking) || expenses.hijacking.ransomPaid;
      expenses.vesselPurchases.total = getValue(gameExp.vesselPurchases) || expenses.vesselPurchases.total;

      // Add any dynamic categories from game-log that we don't have predefined
      // Skip 'marketing' since it's already handled as 'campaigns' above
      const skipKeys = new Set(['total', 'marketing']);
      Object.keys(gameExp).forEach(key => {
        if (!skipKeys.has(key) &amp;&amp; !expenses[key]) {
          const val = getValue(gameExp[key]);
          expenses[key] = { total: val, count: 0, auto: 0, manual: val };
        }
      });
    }
  } catch (err) {
    // If getMergedSummary fails, continue with local data only
    logger.warn('[Aggregator] Could not merge game-log data into detailedExpenses:', err.message);
  }

  // Use game-log grand total if available, otherwise calculate from all categories
  let grandTotal = gameGrandTotal;
  if (!grandTotal) {
    grandTotal = 0;
    Object.keys(expenses).forEach(key => {
      if (expenses[key] &amp;&amp; typeof expenses[key].total === 'number') {
        grandTotal += expenses[key].total;
      } else if (key === 'hijacking' &amp;&amp; expenses[key]) {
        grandTotal += expenses[key].ransomPaid || 0;
      }
    });
  }

  return {
    ...expenses,
    grandTotal,
    netVesselCost: expenses.vesselPurchases.total - expenses.vesselSales.total
  };
}

/**
 * Get all action types from the log (for filtering UI)
 * @param {string} userId - User ID
 * @returns {Promise&lt;Array>} Unique action types
 */
async function getActionTypes(userId) {
  const logs = await loadAuditLog(userId);
  const types = [...new Set(logs.map(log => log.autopilot))].sort();
  return types;
}

/**
 * Get raw log entries with optional filtering
 * @param {string} userId - User ID
 * @param {number} days - Number of days
 * @param {Array} actions - Filter by action types (optional)
 * @param {string} status - Filter by status (optional)
 * @returns {Promise&lt;Array>} Filtered log entries
 */
async function getFilteredLogs(userId, days = 30, actions = null, status = null) {
  const logs = await loadAuditLog(userId);
  let filtered = filterByDays(logs, days);

  if (actions &amp;&amp; actions.length > 0) {
    filtered = filterByType(filtered, actions);
  }

  if (status) {
    filtered = filtered.filter(log => log.status === status);
  }

  // Sort by timestamp descending (newest first)
  filtered.sort((a, b) => b.timestamp - a.timestamp);

  return filtered;
}

/**
 * Map game transaction context to expense category
 * @param {string} context - Game API transaction context
 * @returns {string} Category name
 */
function mapContextToCategory(context) {
  const mapping = {
    // Purchases
    fuel_purchased: 'fuel',
    co2_emission_quota: 'co2',
    // Maintenance
    bulk_wear_maintenance: 'repairs',
    bulk_vessel_major_service: 'drydock',
    vessel_major_service: 'drydock',
    // Operations
    marketing_campaign_activation: 'marketing',
    salary_payment: 'salary',
    harbor_fee_on_depart: 'harborFees',
    guard_payment_on_depart: 'guards',
    route_fee_on_creating: 'routeFees',
    anchor_points: 'anchors',
    // Vessels
    buy_vessel: 'vesselPurchases',
    Vessel_build_Purchase: 'vesselBuilding',
    sell_vessel: 'vesselSales',
    Sold_vessel_in_port: 'vesselSales',
    // Revenue
    vessels_departed: 'revenue',
    // Stocks
    purchase_stock: 'stockPurchases',
    sell_stock: 'stockSales',
    Increase_shares: 'stockDividends',
    // Losses
    hijacking: 'hijacking',
    pirate_raid: 'pirateRaid',
    // Alliance
    alliance_contribution: 'allianceContribution',
    // Bonuses
    daily_bonus: 'bonus',
    ad_video: 'adBonus'
  };
  return mapping[context] || context;
}

/**
 * Map game transaction context to audit log autopilot types
 * Returns the Auto- type that would match this game context
 * @param {string} context - Game API transaction context
 * @returns {string|null} Audit log Auto- type or null if no autopilot equivalent
 */
function mapContextToAutopilotType(context) {
  const mapping = {
    fuel_purchased: 'Auto-Fuel',
    co2_emission_quota: 'Auto-CO2',
    bulk_wear_maintenance: 'Auto-Repair',
    bulk_vessel_major_service: 'Auto-Drydock',
    vessel_major_service: 'Auto-Drydock',
    marketing_campaign_activation: 'Auto-Campaign',
    anchor_points: 'Auto-Anchor',
    vessels_departed: 'Auto-Depart'
  };
  return mapping[context];
}

/**
 * Check if a game transaction was triggered by autopilot
 * Matches game transaction timestamp with audit log entries
 * @param {Object} gameTransaction - Game transaction with time (unix timestamp)
 * @param {Array} auditLogs - Filtered audit log entries
 * @param {string} autopilotType - The Auto- type to look for (e.g. 'Auto-Fuel')
 * @returns {boolean} True if matching autopilot entry found
 */
function isAutopilotTransaction(gameTransaction, auditLogs, autopilotType) {
  if (!autopilotType) return false;

  const gameTimeMs = gameTransaction.time * 1000;
  const tolerance = 120000; // 2 minute tolerance for matching

  return auditLogs.some(log => {
    if (log.autopilot !== autopilotType) return false;
    if (log.status !== 'SUCCESS') return false;

    const timeDiff = Math.abs(log.timestamp - gameTimeMs);
    return timeDiff &lt;= tolerance;
  });
}

/**
 * Get merged summary combining game transactions with local autopilot data
 * Game transactions are the PRIMARY source for financial data (most complete)
 * Local autopilot logs provide additional detail (vessel names, routes, contribution per vessel)
 *
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze
 * @returns {Promise&lt;Object>} Merged analytics summary
 */
async function getMergedSummary(userId, days = 7) {
  // Get game transactions (primary financial source)
  const gameTransactions = await transactionStore.getTransactionsByDays(userId, days);

  // Get local autopilot logs (for detail enrichment)
  const localLogs = await loadAuditLog(userId);
  const filteredLogs = filterByDays(localLogs, days);

  // Aggregate game transactions by category
  const income = {
    total: 0,
    revenue: 0,
    stockSales: 0,
    stockDividends: 0,
    vesselSales: 0,
    bonus: 0,
    adBonus: 0
  };

  // Expenses with auto/manual breakdown
  // Structure: { total, auto, manual } for categories that can be autopilot
  const expenses = {
    total: 0,
    fuel: { total: 0, auto: 0, manual: 0 },
    co2: { total: 0, auto: 0, manual: 0 },
    repairs: { total: 0, auto: 0, manual: 0 },
    drydock: { total: 0, auto: 0, manual: 0 },
    marketing: { total: 0, auto: 0, manual: 0 },
    salary: 0,
    harborFees: 0,
    guards: 0,
    routeFees: 0,
    anchors: { total: 0, auto: 0, manual: 0 },
    stockPurchases: 0,
    vesselPurchases: 0,
    vesselBuilding: 0,
    hijacking: 0,
    pirateRaid: 0,
    allianceContribution: 0
  };

  // Categories that can have auto/manual breakdown
  const autoCategories = new Set(['fuel', 'co2', 'repairs', 'drydock', 'marketing', 'anchors']);

  // Process game transactions with auto/manual matching
  gameTransactions.forEach(t => {
    const category = mapContextToCategory(t.context);
    const autopilotType = mapContextToAutopilotType(t.context);

    if (t.cash >= 0) {
      // Income
      income.total += t.cash;
      if (income[category] !== undefined) {
        income[category] += t.cash;
      } else {
        // Dynamic category - add it to income object
        income[category] = t.cash;
      }
    } else {
      // Expense (absolute value)
      const amount = Math.abs(t.cash);
      expenses.total += amount;

      // Check if this was an autopilot transaction by matching with audit log
      const isAuto = isAutopilotTransaction(t, filteredLogs, autopilotType);

      if (autoCategories.has(category)) {
        // Category supports auto/manual breakdown
        if (!expenses[category]) {
          expenses[category] = { total: 0, auto: 0, manual: 0 };
        }
        expenses[category].total += amount;
        if (isAuto) {
          expenses[category].auto += amount;
        } else {
          expenses[category].manual += amount;
        }
      } else if (expenses[category] !== undefined) {
        // Simple category (just a number)
        if (typeof expenses[category] === 'number') {
          expenses[category] += amount;
        } else {
          expenses[category].total += amount;
        }
      } else {
        // Dynamic category - add it to expenses object as simple number
        expenses[category] = amount;
      }
    }
  });

  // Net vessel cost (purchases - sales from game data)
  const vesselSalesTotal = gameTransactions
    .filter(t => t.context === 'sell_vessel' || t.context === 'Sold_vessel_in_port')
    .reduce((sum, t) => sum + t.cash, 0);

  // Get merged departures (local logs + game history) for enrichment
  const departures = await getMergedDepartures(userId, days);

  // Operations data from merged departures (local logs + game history)
  let totalTrips = 0;
  let totalFuelUsed = 0;
  let totalCO2Used = 0;
  let totalContribution = 0;
  let totalDistance = 0;

  // Track trips per day for chart
  const dailyTripsMap = new Map();

  departures.forEach(log => {
    // Get vessels array (works for both local logs and game history)
    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    const vesselCount = log.details?.vesselCount || vessels.length;

    totalTrips += vesselCount;
    totalFuelUsed += log.details?.totalFuelUsed || 0;
    totalCO2Used += log.details?.totalCO2Used || 0;
    totalContribution += log.details?.contributionGainedTotal || 0;

    // Track trips by day
    const date = new Date(log.timestamp);
    const dayKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
    dailyTripsMap.set(dayKey, (dailyTripsMap.get(dayKey) || 0) + vesselCount);

    // Sum distance and fuel from vessels
    vessels.forEach(v => {
      totalDistance += v.distance || 0;
      // Game history stores fuel per vessel
      if (!log.details?.totalFuelUsed &amp;&amp; v.fuelUsed) {
        totalFuelUsed += v.fuelUsed;
      }
    });
  });

  // Calculate profit
  const netProfit = income.total - expenses.total;
  const profitMargin = income.total > 0 ? (netProfit / income.total) * 100 : 0;

  // Calculate avg fuel price from local purchase logs
  const fuelPurchases = filterByType(filteredLogs, ['Auto-Fuel', 'Manual Fuel Purchase'])
    .filter(p => p.status === 'SUCCESS');
  const avgFuelPrice = calculateWeightedAverage(fuelPurchases);

  // Build daily breakdown from game transactions
  const dailyMap = new Map();
  gameTransactions.forEach(t => {
    const date = new Date(t.time * 1000).toISOString().split('T')[0];
    if (!dailyMap.has(date)) {
      dailyMap.set(date, {
        date,
        income: 0,
        expenses: 0,
        net: 0,
        trips: 0,
        byContext: {},
        byVessel: {}
      });
    }
    const day = dailyMap.get(date);
    if (t.cash >= 0) {
      day.income += t.cash;
    } else {
      day.expenses += Math.abs(t.cash);
    }
    day.net = day.income - day.expenses;

    if (!day.byContext[t.context]) {
      day.byContext[t.context] = 0;
    }
    day.byContext[t.context] += t.cash;
  });

  // Add trips data from departures to daily breakdown
  dailyTripsMap.forEach((trips, date) => {
    if (dailyMap.has(date)) {
      dailyMap.get(date).trips = trips;
    } else {
      // Day has trips but no transactions - still add it
      dailyMap.set(date, {
        date,
        income: 0,
        expenses: 0,
        net: 0,
        trips,
        byContext: {},
        byVessel: {}
      });
    }
  });

  // Add byVessel data and utilization from Lookup Store (POD4)
  try {
    const lookupEntries = await lookupStore.getEntriesByDays(userId, days);
    for (const entry of lookupEntries) {
      // Only departure entries have vessel assignments
      if (entry.context !== 'vessels_departed') continue;

      // Try pod2_vessel first (audit log match), then pod3_vessel (vessel history) as fallback
      const vessel = entry.pod2_vessel || entry.pod3_vessel;
      if (!vessel) continue;

      const vesselId = vessel.vesselId || vessel.vessel_id || vessel.id;
      if (!vesselId) continue;

      const date = new Date(entry.timestamp).toISOString().split('T')[0];
      if (!dailyMap.has(date)) continue;

      const day = dailyMap.get(date);
      if (!day.byVessel) day.byVessel = {};
      if (!day.byVessel[vesselId]) day.byVessel[vesselId] = 0;

      // Use the income from the departure (brutto = income + harborFee)
      day.byVessel[vesselId] += entry.cash;

      // Aggregate utilization data per day
      const utilization = vessel.utilization;
      if (typeof utilization === 'number') {
        // Initialize utilization tracking for this day
        if (!day.utilizationSum) day.utilizationSum = 0;
        if (!day.utilizationCount) day.utilizationCount = 0;
        if (!day.utilizationRanges) {
          day.utilizationRanges = { '0-25': 0, '25-50': 0, '50-75': 0, '75-100': 0 };
        }

        day.utilizationSum += utilization;
        day.utilizationCount++;

        // Categorize into ranges (utilization is 0-1)
        const utilPercent = utilization * 100;
        if (utilPercent &lt; 25) {
          day.utilizationRanges['0-25']++;
        } else if (utilPercent &lt; 50) {
          day.utilizationRanges['25-50']++;
        } else if (utilPercent &lt; 75) {
          day.utilizationRanges['50-75']++;
        } else {
          day.utilizationRanges['75-100']++;
        }
      }
    }
  } catch (err) {
    logger.warn('[Aggregator] Failed to load lookup entries for byVessel:', err.message);
  }

  // Calculate avgUtilization per day
  for (const day of dailyMap.values()) {
    if (day.utilizationCount > 0) {
      day.avgUtilization = day.utilizationSum / day.utilizationCount;
    } else {
      day.avgUtilization = null;
    }
    // Clean up temp fields
    delete day.utilizationSum;
    delete day.utilizationCount;
  }

  const dailyBreakdown = Array.from(dailyMap.values()).sort((a, b) => a.date.localeCompare(b.date));

  // Debug: verify dailyBreakdown sums match income/expenses totals
  const dailyIncomeSum = dailyBreakdown.reduce((sum, d) => sum + d.income, 0);
  const dailyExpensesSum = dailyBreakdown.reduce((sum, d) => sum + d.expenses, 0);
  if (Math.abs(dailyIncomeSum - income.total) > 1 || Math.abs(dailyExpensesSum - expenses.total) > 1) {
    logger.warn(`[Aggregator] dailyBreakdown mismatch! income: ${dailyIncomeSum} vs ${income.total}, expenses: ${dailyExpensesSum} vs ${expenses.total}`);
  }

  // Build chart entries from game transactions (individual points with timestamps)
  // LightweightCharts expects time in seconds (Unix timestamp)
  const chartEntries = gameTransactions.map(t => ({
    time: t.time, // Already in seconds
    value: t.cash,
    type: t.cash >= 0 ? 'income' : 'expense',
    context: t.context
  })).sort((a, b) => a.time - b.time);

  // Build utilization and vessel revenue entries from merged departures (same source as vessel performance)
  const utilizationEntries = [];
  const vesselRevenueEntries = [];
  try {
    // Get current vessel names to use instead of historical names
    let currentVesselNames = new Map();
    try {
      const gameapi = require('../gameapi');
      const currentVessels = await gameapi.fetchVessels();
      currentVessels.forEach(v => {
        if (v.id &amp;&amp; v.name) {
          currentVesselNames.set(Number(v.id), v.name);
        }
      });
    } catch (err) {
      logger.warn('[Aggregator] Could not fetch current vessel names:', err.message);
    }

    // Use getMergedDepartures to get ALL departures (local + game history)
    const mergedDepartures = await getMergedDepartures(userId, days);

    for (const log of mergedDepartures) {
      const vessels = log.details?.departedVessels || log.details?.vessels || [];
      const logTimestamp = log.timestamp || log.details?.timestamp;

      for (const vessel of vessels) {
        const vesselId = vessel.vesselId || vessel.vessel_id;
        // Use current name if available, otherwise fall back to historical name
        const historicalName = vessel.name || vessel.vesselName || 'Unknown';
        const vesselName = (vesselId &amp;&amp; currentVesselNames.get(Number(vesselId))) || historicalName;
        const timeSeconds = Math.floor(logTimestamp / 1000);

        // Utilization entries
        const utilization = vessel.utilization;
        if (typeof utilization === 'number') {
          utilizationEntries.push({
            time: timeSeconds,
            value: utilization * 100, // Convert 0-1 to 0-100%
            vesselName
          });
        }

        // Vessel revenue entries - use income which can be negative
        const vesselIncome = vessel.income;
        if (vesselId &amp;&amp; typeof vesselIncome === 'number') {
          vesselRevenueEntries.push({
            time: timeSeconds,
            value: vesselIncome,
            vesselId,
            vesselName
          });
        }
      }
    }
    utilizationEntries.sort((a, b) => a.time - b.time);
    vesselRevenueEntries.sort((a, b) => a.time - b.time);
  } catch (err) {
    logger.warn('[Aggregator] Failed to build utilization/revenue entries:', err.message);
  }

  return {
    source: 'merged',
    period: {
      days,
      from: Date.now() - (days * 24 * 60 * 60 * 1000),
      to: Date.now()
    },
    income,
    expenses,
    profit: {
      net: netProfit,
      margin: profitMargin
    },
    operations: {
      trips: totalTrips,
      fuelUsed: totalFuelUsed,
      co2Used: totalCO2Used,
      contribution: totalContribution,
      distance: totalDistance
    },
    averages: {
      fuelPrice: avgFuelPrice
    },
    vesselNetCost: (typeof expenses.vesselPurchases === 'number' ? expenses.vesselPurchases : expenses.vesselPurchases.total) - vesselSalesTotal,
    transactionCount: gameTransactions.length,
    dailyBreakdown,
    // Individual entries for zoomable charts (timestamp in seconds)
    chartEntries,
    utilizationEntries,
    vesselRevenueEntries,
    // Include raw context totals for detailed breakdown
    byContext: gameTransactions.reduce((acc, t) => {
      if (!acc[t.context]) {
        acc[t.context] = { income: 0, expenses: 0, count: 0 };
      }
      acc[t.context].count++;
      if (t.cash >= 0) {
        acc[t.context].income += t.cash;
      } else {
        acc[t.context].expenses += Math.abs(t.cash);
      }
      return acc;
    }, {})
  };
}

/**
 * Get vessel performance with contribution from merged data (local + game history)
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze
 * @returns {Promise&lt;Array>} Vessel performance with contribution
 */
async function getVesselPerformanceWithContribution(userId, days = 30) {
  // Use merged departures (local logs + game import)
  const vesselPerf = await getVesselPerformanceMerged(userId, days);

  // Get current vessels to determine which are still owned and get current names
  let ownedVesselIds = new Set();
  let currentVesselNames = new Map(); // vesselId -> current name
  try {
    const gameapi = require('../gameapi');
    const currentVessels = await gameapi.fetchVessels();

    // Store IDs and names for consistent comparison
    currentVessels.forEach(v => {
      if (v.id) {
        const numId = Number(v.id);
        ownedVesselIds.add(numId);
        if (v.name) {
          currentVesselNames.set(numId, v.name);
        }
      }
    });
  } catch (err) {
    logger.warn('[Analytics] Could not fetch current vessels for ownership check:', err.message);
  }

  // Ensure contribution field is properly named, add ownership info, and update names
  // Convert vesselId to number for comparison (could be string from logs)
  return vesselPerf.map(v => {
    const numId = Number(v.vesselId);
    const currentName = currentVesselNames.get(numId);
    return {
      ...v,
      // Use current name if vessel still owned, otherwise keep historical name
      name: currentName || v.name,
      contribution: v.totalContribution,
      isOwned: ownedVesselIds.size > 0 ? ownedVesselIds.has(numId) : true
    };
  });
}

/**
 * Get route profitability with contribution from merged data (local + game history)
 * Also includes active vessel counts per route
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze
 * @returns {Promise&lt;Array>} Route profitability with contribution and active vessel info
 */
async function getRouteProfitabilityWithContribution(userId, days = 30) {
  // Use merged departures (local logs + game import)
  const routeProf = await getRouteProfitabilityMerged(userId, days);

  // Get current vessels to determine active routes
  // Routes are normalized (alphabetically sorted), so A->B and B->A map to the same key
  let activeRouteVessels = {};
  try {
    const gameapi = require('../gameapi');
    const currentVessels = await gameapi.fetchVessels();

    // Count vessels per route using normalized key
    currentVessels.forEach(v => {
      if (v.route_origin &amp;&amp; v.route_destination) {
        // Use normalized key so A->B and B->A count toward the same route
        const routeKey = normalizeRouteKey(v.route_origin, v.route_destination);

        if (!activeRouteVessels[routeKey]) activeRouteVessels[routeKey] = 0;
        activeRouteVessels[routeKey]++;
      }
    });
  } catch (err) {
    logger.warn('[Analytics] Could not fetch current vessels for active route detection:', err.message);
  }

  // Ensure contribution field is properly named and add active vessel info
  return routeProf.map(r => {
    const activeCount = activeRouteVessels[r.route] || 0;
    return {
      ...r,
      contribution: r.totalContribution || 0,
      avgContribPerTrip: r.totalContribution &amp;&amp; r.trips ? r.totalContribution / r.trips : 0,
      activeVesselCount: activeCount,
      isActive: activeCount > 0
    };
  });
}

/**
 * Get merged departure logs combining local autopilot logs with Game API history
 * Strategy:
 * - Before first local log: use only Game Departure data
 * - After first local log: use both, deduplicate by vessel+timestamp (within 5 min window)
 *
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze
 * @returns {Promise&lt;Array>} Merged departure entries
 */
async function getMergedDepartures(userId, days) {
  const localLogs = await loadAuditLog(userId);
  const localDepartures = filterByType(
    filterByDays(localLogs, days),
    ['Auto-Depart', 'Manual Depart']
  ).filter(log => log.status === 'SUCCESS');

  // Get game history departures
  const gameDepartures = await vesselHistoryStore.getDeparturesByDays(userId, days);

  // If no local departures, use only game departures
  if (localDepartures.length === 0) {
    return gameDepartures;
  }

  // Find earliest local log timestamp
  const earliestLocal = Math.min(...localDepartures.map(d => d.timestamp));

  // Split game departures: before and after earliest local
  const gameBeforeLocal = gameDepartures.filter(d => d.timestamp &lt; earliestLocal);
  const gameAfterLocal = gameDepartures.filter(d => d.timestamp >= earliestLocal);

  // Build set of local departure keys for deduplication (vessel_id + rounded timestamp)
  const DEDUP_WINDOW = 5 * 60 * 1000; // 5 minutes
  const localKeys = new Set();

  // Build map of game departures for duration lookup
  const gameDurationMap = new Map();
  gameAfterLocal.forEach(d => {
    const vessels = d.details?.departedVessels || [];
    if (vessels.length > 0 &amp;&amp; vessels[0]?.vesselId) {
      const vesselId = vessels[0].vesselId;
      const roundedTime = Math.floor(d.timestamp / DEDUP_WINDOW) * DEDUP_WINDOW;
      const key = `${vesselId}-${roundedTime}`;
      if (vessels[0].duration) {
        gameDurationMap.set(key, vessels[0].duration);
      }
    }
  });

  localDepartures.forEach(log => {
    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    vessels.forEach(v => {
      const vesselId = v.vesselId || v.vessel_id;
      if (vesselId) {
        // Round timestamp to nearest 5 minutes for fuzzy matching
        const roundedTime = Math.floor(log.timestamp / DEDUP_WINDOW) * DEDUP_WINDOW;
        localKeys.add(`${vesselId}-${roundedTime}`);
        // Enrich local entry with duration from game data if missing
        if (!v.duration) {
          const key = `${vesselId}-${roundedTime}`;
          const gameDuration = gameDurationMap.get(key);
          if (gameDuration) {
            v.duration = gameDuration;
          }
        }
      }
    });
  });

  // Filter game departures after local to remove duplicates
  const dedupedGameAfter = gameAfterLocal.filter(d => {
    const vessels = d.details?.departedVessels || [];
    if (vessels.length === 0) return false;

    const vesselId = vessels[0]?.vesselId;
    if (!vesselId) return false;

    const roundedTime = Math.floor(d.timestamp / DEDUP_WINDOW) * DEDUP_WINDOW;
    const key = `${vesselId}-${roundedTime}`;
    return !localKeys.has(key);
  });

  // Combine all sources
  const merged = [
    ...gameBeforeLocal,
    ...localDepartures,
    ...dedupedGameAfter
  ];

  // Sort by timestamp
  merged.sort((a, b) => a.timestamp - b.timestamp);

  return merged;
}

/**
 * Get vessel performance using merged departure data (local + game history)
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze (default 30)
 * @returns {Promise&lt;Array>} Vessel performance data
 */
async function getVesselPerformanceMerged(userId, days = 30) {
  const departures = await getMergedDepartures(userId, days);

  // Aggregate by vessel
  const vesselMap = new Map();

  departures.forEach(log => {
    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    vessels.forEach(v => {
      const id = v.vesselId || v.vessel_id;
      if (!id) return;

      if (!vesselMap.has(id)) {
        vesselMap.set(id, {
          vesselId: id,
          name: v.name || v.vesselName || `Vessel ${id}`,
          trips: 0,
          totalRevenue: 0,
          totalFuelUsed: 0,
          totalCO2Used: 0,
          totalHarborFees: 0,
          totalContribution: 0,
          totalDistance: 0,
          totalDuration: 0,
          utilizationSum: 0,
          totalCargoTeu: 0,
          totalCargoBbl: 0,
          routes: new Map(),
          sources: { local: 0, game: 0 }
        });
      }

      const vessel = vesselMap.get(id);
      vessel.trips++;
      vessel.totalRevenue += v.income || 0;
      vessel.totalFuelUsed += v.fuelUsed || 0;
      vessel.totalCO2Used += v.co2Used || 0;
      vessel.totalHarborFees += Math.abs(v.harborFee || 0);
      vessel.totalContribution += v.contributionGained || 0;
      vessel.totalDistance += v.distance || 0;
      vessel.totalDuration += v.duration || 0;
      vessel.utilizationSum += v.utilization || 0;

      // Aggregate cargo - TEU for containers, bbl for tankers
      if (v.cargo) {
        const teu = (v.cargo.dry || 0) + (v.cargo.refrigerated || 0);
        const bbl = (v.cargo.fuel || 0) + (v.cargo.crude || 0);
        vessel.totalCargoTeu += teu;
        vessel.totalCargoBbl += bbl;
      }

      // Track source
      if (log.source === 'game-api') {
        vessel.sources.game++;
      } else {
        vessel.sources.local++;
      }

      // Track routes
      const routeKey = `${v.origin}&lt;>${v.destination}`;
      if (v.origin &amp;&amp; v.destination) {
        const current = vessel.routes.get(routeKey);
        vessel.routes.set(routeKey, current ? current + 1 : 1);
      }
    });
  });

  // Calculate averages and convert to array
  const results = [];
  vesselMap.forEach((vessel, id) => {
    const avgUtilization = vessel.trips > 0 ? vessel.utilizationSum / vessel.trips : 0;
    const avgRevenuePerTrip = vessel.trips > 0 ? vessel.totalRevenue / vessel.trips : 0;
    const fuelEfficiency = vessel.totalFuelUsed > 0 ? vessel.totalDistance / vessel.totalFuelUsed : 0;
    // Duration is in seconds, convert to hours for avg/h calculation
    const totalHours = vessel.totalDuration / 3600;
    const avgRevenuePerHour = totalHours > 0 ? vessel.totalRevenue / totalHours : 0;
    const avgRevenuePerNm = vessel.totalDistance > 0 ? vessel.totalRevenue / vessel.totalDistance : 0;

    // Cargo efficiency metrics - TEU for containers, bbl for tankers
    const cargoType = vessel.totalCargoTeu > vessel.totalCargoBbl ? 'TEU' : 'bbl';
    const primaryCargo = vessel.totalCargoTeu > vessel.totalCargoBbl ? vessel.totalCargoTeu : vessel.totalCargoBbl;
    // Revenue per cargo unit per NM (how efficiently is cargo transported)
    const avgRevenuePerCargoNm = (primaryCargo > 0 &amp;&amp; vessel.totalDistance > 0)
      ? vessel.totalRevenue / primaryCargo / vessel.totalDistance
      : 0;
    const avgCargoPerTrip = vessel.trips > 0 ? primaryCargo / vessel.trips : 0;

    // Find most used route
    let primaryRoute = null;
    let maxRouteTrips = 0;
    vessel.routes.forEach((count, route) => {
      if (count > maxRouteTrips) {
        maxRouteTrips = count;
        primaryRoute = route;
      }
    });

    results.push({
      vesselId: id,
      name: vessel.name,
      trips: vessel.trips,
      totalRevenue: vessel.totalRevenue,
      totalFuelUsed: vessel.totalFuelUsed,
      totalCO2Used: vessel.totalCO2Used,
      totalHarborFees: vessel.totalHarborFees,
      totalContribution: vessel.totalContribution,
      totalDistance: vessel.totalDistance,
      totalDuration: vessel.totalDuration,
      totalCargoTeu: vessel.totalCargoTeu,
      totalCargoBbl: vessel.totalCargoBbl,
      cargoType,
      avgUtilization: avgUtilization * 100,
      avgRevenuePerTrip,
      avgRevenuePerHour,
      avgRevenuePerNm,
      avgRevenuePerCargoNm,
      avgCargoPerTrip,
      fuelEfficiency,
      primaryRoute: formatRouteDisplay(primaryRoute),
      routeCount: vessel.routes.size,
      dataSources: vessel.sources
    });
  });

  // Sort by revenue descending
  results.sort((a, b) => b.totalRevenue - a.totalRevenue);

  return results;
}

/**
 * Load vessel_name from hijack_history file as fallback
 * @param {string} userId - User ID
 * @param {string} caseId - Hijacking case ID
 * @returns {Promise&lt;string|null>} vessel_name or null if not found
 */
async function getVesselNameFromHijackHistory(userId, caseId) {
  try {
    const filePath = path.join(HIJACK_HISTORY_DIR, `${userId}-${caseId}.json`);
    const data = await fs.readFile(filePath, 'utf8');
    const history = JSON.parse(data);
    return history.vessel_name || null;
  } catch {
    // File doesn't exist or parse error - expected for old entries
    return null;
  }
}

/**
 * Get hijacking risk percentages from stored vessel history data.
 * Routes are collected from vessel history sync which captures hijacking_risk per route.
 * UI should only read from stored data - background sync keeps it updated.
 * @param {string} userId - User ID
 * @returns {Promise&lt;Map&lt;string, number>>} Route key -> hijacking_risk (0-100)
 */
async function fetchGameHijackingRisks(userId) {
  const riskMap = new Map();

  try {
    // Get stored hijacking risks from vessel history (synced by background process)
    const storedRisks = await vesselHistoryStore.getRouteHijackingRisks(userId);
    for (const [key, value] of storedRisks) {
      riskMap.set(key, value);
    }
    logger.debug(`[Aggregator] Loaded hijacking risk for ${riskMap.size} routes from stored data`);

    return riskMap;
  } catch (err) {
    logger.error('[Aggregator] Failed to get hijacking risks:', err.message);
    return riskMap;
  }
}

/**
 * Calculate actual hijacking counts per route from logbook data.
 * Matches hijacking cases to departures by vessel name and timestamp.
 * Returns a Map of "origin&lt;>destination" -> hijack count
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze
 * @param {Array} departures - Departure logs (to avoid re-fetching)
 * @returns {Promise&lt;Map&lt;string, number>>} Route hijack count map
 */
async function calculateRouteHijackCounts(userId, days, departures) {
  const hijackCountMap = new Map();

  try {
    const logs = await loadAuditLog(userId);
    const filtered = filterByDays(logs, days);

    // Get all hijacking cases
    const hijackCases = filtered.filter(log =>
      log.autopilot === 'Auto-Blackbeard' ||
      log.autopilot === 'Manual Ransom' ||
      log.autopilot === 'Manual Pay Ransom'
    );

    if (hijackCases.length === 0) {
      logger.debug('[Aggregator] No hijacking cases found in logbook');
      return hijackCountMap;
    }

    // Build a lookup of vessel departures sorted by timestamp (newest first)
    // Key: vessel name (lowercase), Value: array of {timestamp, origin, destination}
    const vesselDepartures = new Map();

    departures.forEach(log => {
      const vessels = log.details?.departedVessels || log.details?.vessels || [];
      const departureTime = log.timestamp;

      vessels.forEach(v => {
        const vesselName = (v.name || '').toLowerCase().trim();
        const origin = v.origin || '';
        const destination = v.destination || '';

        if (!vesselName || !origin || !destination) return;

        if (!vesselDepartures.has(vesselName)) {
          vesselDepartures.set(vesselName, []);
        }
        vesselDepartures.get(vesselName).push({
          timestamp: departureTime,
          origin,
          destination
        });
      });
    });

    // Sort each vessel's departures by timestamp descending (newest first)
    vesselDepartures.forEach(deps => {
      deps.sort((a, b) => b.timestamp - a.timestamp);
    });

    // Match each hijacking case to a departure
    let matchedCount = 0;
    for (const hijack of hijackCases) {
      // Support both old (vesselName) and new (vessel_name) field names
      let vesselName = (hijack.details?.vessel_name || hijack.details?.vesselName || '').toLowerCase().trim();
      const hijackTime = hijack.timestamp;
      const caseId = hijack.details?.case_id;

      // Fallback: try to get vessel_name from hijack_history file if not in audit log
      if (!vesselName &amp;&amp; caseId) {
        const historyVesselName = await getVesselNameFromHijackHistory(userId, caseId);
        if (historyVesselName) {
          vesselName = historyVesselName.toLowerCase().trim();
        }
      }

      if (!vesselName) continue;

      const deps = vesselDepartures.get(vesselName);
      if (!deps || deps.length === 0) continue;

      // Find the most recent departure BEFORE the hijacking
      const matchedDeparture = deps.find(d => d.timestamp &lt; hijackTime);

      if (matchedDeparture) {
        const routeKey = normalizeRouteKey(matchedDeparture.origin, matchedDeparture.destination);

        hijackCountMap.set(routeKey, (hijackCountMap.get(routeKey) || 0) + 1);
        matchedCount++;
      }
    }

    logger.debug(`[Aggregator] Matched ${matchedCount}/${hijackCases.length} hijacking cases to routes`);
  } catch (err) {
    logger.error('[Aggregator] Failed to calculate hijack counts:', err.message);
  }

  return hijackCountMap;
}


/**
 * Aggregate ransom payments from audit log by route.
 * Returns total ransom paid and incident count per route.
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze
 * @param {Array} departures - Departure logs for route matching
 * @returns {Promise&lt;Map&lt;string, {totalRansom: number, count: number}>>} Map of route -> ransom data
 */
async function aggregateRansomPayments(userId, days, departures) {
  const ransomMap = new Map();

  try {
    const logs = await loadAuditLog(userId);
    const filtered = filterByDays(logs, days);

    // Get all ransom payment cases
    const ransomCases = filtered.filter(log =>
      log.autopilot === 'Auto-Blackbeard' ||
      log.autopilot === 'Manual Ransom' ||
      log.autopilot === 'Manual Pay Ransom'
    );

    if (ransomCases.length === 0) {
      logger.debug('[Aggregator] No ransom payment cases found');
      return ransomMap;
    }

    // Build vessel departure lookup (newest first)
    const vesselDepartures = new Map();
    departures.forEach(log => {
      const vessels = log.details?.departedVessels || log.details?.vessels || [];
      const departureTime = log.timestamp;

      vessels.forEach(v => {
        const vesselName = (v.name || '').toLowerCase().trim();
        const origin = v.origin || '';
        const destination = v.destination || '';

        if (!vesselName || !origin || !destination) return;

        if (!vesselDepartures.has(vesselName)) {
          vesselDepartures.set(vesselName, []);
        }
        vesselDepartures.get(vesselName).push({
          timestamp: departureTime,
          origin,
          destination
        });
      });
    });

    // Sort each vessel's departures by timestamp descending
    vesselDepartures.forEach(deps => {
      deps.sort((a, b) => b.timestamp - a.timestamp);
    });

    // Match ransom payments to routes
    ransomCases.forEach(ransom => {
      // Extract ransom amount from summary (e.g., "Paid $5.624.000 ransom for Case #1055075")
      const amountMatch = ransom.summary?.match(/\$([0-9.,]+)/);
      let ransomAmount = 0;
      if (amountMatch) {
        ransomAmount = parseInt(amountMatch[1].replace(/[.,]/g, ''), 10);
      }

      // Get vessel name from local audit log data
      const vesselName = (ransom.details?.vessel_name || ransom.details?.vesselName || '').toLowerCase().trim();

      if (!vesselName) return;

      const deps = vesselDepartures.get(vesselName);
      if (!deps || deps.length === 0) return;

      // Find the most recent departure BEFORE the ransom payment
      const matchedDeparture = deps.find(d => d.timestamp &lt; ransom.timestamp);

      if (matchedDeparture) {
        const routeKey = normalizeRouteKey(matchedDeparture.origin, matchedDeparture.destination);

        if (!ransomMap.has(routeKey)) {
          ransomMap.set(routeKey, { totalRansom: 0, count: 0 });
        }
        const data = ransomMap.get(routeKey);
        data.totalRansom += ransomAmount;
        data.count++;
      }
    });

    logger.debug(`[Aggregator] Aggregated ransom payments for ${ransomMap.size} routes`);
  } catch (err) {
    logger.error('[Aggregator] Failed to aggregate ransom payments:', err.message);
  }

  return ransomMap;
}

/**
 * Get route profitability using merged departure data (local + game history)
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze (default 30)
 * @returns {Promise&lt;Array>} Route profitability data
 */
async function getRouteProfitabilityMerged(userId, days = 30) {
  // Get departures first (needed for hijack rate calculation)
  const departures = await getMergedDepartures(userId, days);

  // Fetch data in parallel: hijack counts, ransom payments, and hijack risks from stored data
  const [hijackCountMap, ransomMap, gameHijackRiskMap] = await Promise.all([
    calculateRouteHijackCounts(userId, days, departures),
    aggregateRansomPayments(userId, days, departures),
    fetchGameHijackingRisks(userId)
  ]);

  // Aggregate by route
  const routeMap = new Map();

  departures.forEach(log => {
    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    vessels.forEach(v => {
      const origin = v.origin || '';
      const destination = v.destination || '';
      if (!origin || !destination) return;

      // Normalize route key so A&lt;>B and B&lt;>A are the same route
      const routeKey = normalizeRouteKey(origin, destination);
      const [normOrigin, normDest] = routeKey.split('&lt;>');

      if (!routeMap.has(routeKey)) {
        routeMap.set(routeKey, {
          route: routeKey,
          origin: normOrigin,
          destination: normDest,
          trips: 0,
          totalRevenue: 0,
          totalHarborFees: 0,
          totalFuelUsed: 0,
          totalDistance: 0,
          totalDuration: 0,
          totalCargoTeu: 0,
          totalCargoBbl: 0,
          vessels: new Set(),
          sources: { local: 0, game: 0 }
        });
      }

      const route = routeMap.get(routeKey);
      route.trips++;
      route.totalRevenue += v.income || 0;
      route.totalHarborFees += Math.abs(v.harborFee || 0);
      route.totalFuelUsed += v.fuelUsed || 0;
      route.totalDistance += v.distance || 0;
      route.totalDuration += v.duration || 0;
      route.vessels.add(v.vesselId || v.vessel_id);

      // Aggregate cargo - TEU for containers, bbl for tankers
      if (v.cargo) {
        route.totalCargoTeu += (v.cargo.dry || 0) + (v.cargo.refrigerated || 0);
        route.totalCargoBbl += (v.cargo.fuel || 0) + (v.cargo.crude || 0);
      }

      // Track source
      if (log.source === 'game-api') {
        route.sources.game++;
      } else {
        route.sources.local++;
      }
    });
  });

  // Calculate metrics and convert to array
  const results = [];
  routeMap.forEach((route) => {
    const avgRevenuePerTrip = route.trips > 0 ? route.totalRevenue / route.trips : 0;
    const avgHarborFee = route.trips > 0 ? route.totalHarborFees / route.trips : 0;
    const harborFeePercent = route.totalRevenue > 0 ? (route.totalHarborFees / route.totalRevenue) * 100 : 0;
    // Distance is in nautical miles
    const avgIncomePerNm = route.totalDistance > 0 ? route.totalRevenue / route.totalDistance : 0;
    // Duration is in seconds, convert to hours for avg/h calculation
    const totalHours = route.totalDuration / 3600;
    const avgRevenuePerHour = totalHours > 0 ? route.totalRevenue / totalHours : 0;

    // Cargo efficiency metrics - TEU for containers, bbl for tankers
    const cargoType = route.totalCargoTeu > route.totalCargoBbl ? 'TEU' : 'bbl';
    const primaryCargo = route.totalCargoTeu > route.totalCargoBbl ? route.totalCargoTeu : route.totalCargoBbl;
    // Revenue per cargo unit per NM (how efficiently is cargo transported on this route)
    const avgRevenuePerCargoNm = (primaryCargo > 0 &amp;&amp; route.totalDistance > 0)
      ? route.totalRevenue / primaryCargo / route.totalDistance
      : 0;
    const avgCargoPerTrip = route.trips > 0 ? primaryCargo / route.trips : 0;
    // Revenue per cargo unit per hour (how much does each TEU/bbl earn per hour on this route)
    const avgRevenuePerCargoHour = (primaryCargo > 0 &amp;&amp; totalHours > 0)
      ? route.totalRevenue / primaryCargo / totalHours
      : 0;

    // Get historical hijack incidents from logbook (actual count of hijacks on this route)
    const hijackCount = hijackCountMap.get(route.route);

    // Get hijacking risk percentage from Game API (route probability)
    // Try both directions since routes can be bidirectional
    let gameHijackRisk = gameHijackRiskMap.get(route.route);
    if (gameHijackRisk === undefined) {
      // Try reverse direction
      const reverseKey = `${route.destination}&lt;>${route.origin}`;
      gameHijackRisk = gameHijackRiskMap.get(reverseKey);
    }

    // Get ransom payment data
    const ransomData = ransomMap.get(route.route);

    results.push({
      route: route.route,
      origin: route.origin,
      destination: route.destination,
      displayRoute: formatRouteDisplay(route.route),
      trips: route.trips,
      totalRevenue: route.totalRevenue,
      totalHarborFees: route.totalHarborFees,
      totalFuelUsed: route.totalFuelUsed,
      totalDistance: route.totalDistance,
      totalDuration: route.totalDuration,
      totalCargoTeu: route.totalCargoTeu,
      totalCargoBbl: route.totalCargoBbl,
      cargoType,
      avgRevenuePerTrip,
      avgHarborFee,
      harborFeePercent,
      avgIncomePerNm,
      avgRevenuePerHour,
      avgRevenuePerCargoNm,
      avgRevenuePerCargoHour,
      avgCargoPerTrip,
      hijackingRisk: gameHijackRisk !== undefined ? gameHijackRisk : null,
      hijackCount: hijackCount !== undefined ? hijackCount : null,
      totalRansomPaid: ransomData ? ransomData.totalRansom : null,
      ransomIncidents: ransomData ? ransomData.count : null,
      vesselCount: route.vessels.size,
      dataSources: route.sources
    });
  });

  // Sort by total revenue descending
  results.sort((a, b) => b.totalRevenue - a.totalRevenue);

  return results;
}

/**
 * Get operations summary from merged departure data
 * @param {string} userId - User ID
 * @param {number} days - Number of days to analyze
 * @returns {Promise&lt;Object>} Operations summary
 */
async function getMergedOperationsSummary(userId, days) {
  const departures = await getMergedDepartures(userId, days);

  let totalTrips = 0;
  let totalRevenue = 0;
  let totalFuelUsed = 0;
  let totalDistance = 0;
  let localCount = 0;
  let gameCount = 0;

  departures.forEach(log => {
    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    totalTrips += vessels.length;

    if (log.source === 'game-api') {
      gameCount++;
    } else {
      localCount++;
    }

    vessels.forEach(v => {
      totalRevenue += v.income || 0;
      totalFuelUsed += v.fuelUsed || 0;
      totalDistance += v.distance || 0;
    });
  });

  return {
    totalTrips,
    totalRevenue,
    totalFuelUsed,
    totalDistance,
    departureCount: departures.length,
    dataSources: {
      local: localCount,
      game: gameCount
    }
  };
}

/**
 * Get vessel performance for a specific route
 * @param {string} userId - User ID
 * @param {string} origin - Route origin port
 * @param {string} destination - Route destination port
 * @param {number} days - Number of days to analyze (default 30)
 * @returns {Promise&lt;Array>} Vessel performance on this route
 */
async function getVesselsByRoute(userId, origin, destination, days = 30) {
  const departures = await getMergedDepartures(userId, days);

  // Normalize route key (A&lt;>B should match B&lt;>A)
  const targetRouteKey = normalizeRouteKey(origin, destination);

  // Aggregate by vessel, but only for trips on this route
  const vesselMap = new Map();

  departures.forEach(log => {
    const vessels = log.details?.departedVessels || log.details?.vessels || [];
    vessels.forEach(v => {
      const vOrigin = v.origin || '';
      const vDestination = v.destination || '';
      if (!vOrigin || !vDestination) return;

      // Check if this trip matches our target route
      const tripRouteKey = normalizeRouteKey(vOrigin, vDestination);
      if (tripRouteKey !== targetRouteKey) return;

      const id = v.vesselId || v.vessel_id;
      if (!id) return;

      if (!vesselMap.has(id)) {
        vesselMap.set(id, {
          vesselId: id,
          name: v.name || v.vesselName || `Vessel ${id}`,
          trips: 0,
          totalRevenue: 0,
          totalDistance: 0,
          totalDuration: 0,
          totalCargoTeu: 0,
          totalCargoBbl: 0
        });
      }

      const vessel = vesselMap.get(id);
      vessel.trips++;
      vessel.totalRevenue += v.income || 0;
      vessel.totalDistance += v.distance || 0;
      vessel.totalDuration += v.duration || 0;

      if (v.cargo) {
        vessel.totalCargoTeu += (v.cargo.dry || 0) + (v.cargo.refrigerated || 0);
        vessel.totalCargoBbl += (v.cargo.fuel || 0) + (v.cargo.crude || 0);
      }
    });
  });

  // Calculate metrics and convert to array
  const results = [];
  vesselMap.forEach((vessel) => {
    const avgRevenuePerTrip = vessel.trips > 0 ? vessel.totalRevenue / vessel.trips : 0;
    const totalHours = vessel.totalDuration / 3600;
    const avgRevenuePerHour = totalHours > 0 ? vessel.totalRevenue / totalHours : 0;
    const avgRevenuePerNm = vessel.totalDistance > 0 ? vessel.totalRevenue / vessel.totalDistance : 0;

    // Cargo metrics
    const cargoType = vessel.totalCargoTeu > vessel.totalCargoBbl ? 'TEU' : 'bbl';
    const primaryCargo = vessel.totalCargoTeu > vessel.totalCargoBbl ? vessel.totalCargoTeu : vessel.totalCargoBbl;
    const avgCargoPerTrip = vessel.trips > 0 ? primaryCargo / vessel.trips : 0;

    results.push({
      vesselId: vessel.vesselId,
      name: vessel.name,
      trips: vessel.trips,
      totalRevenue: vessel.totalRevenue,
      avgRevenuePerTrip,
      avgRevenuePerHour,
      avgRevenuePerNm,
      cargoType,
      avgCargoPerTrip
    });
  });

  // Sort by avgRevenuePerHour descending (most efficient first)
  results.sort((a, b) => b.avgRevenuePerHour - a.avgRevenuePerHour);

  return results;
}

module.exports = {
  loadAuditLog,
  loadTripData,
  getWeeklySummary,
  getVesselPerformance,
  getRouteProfitability,
  getPurchaseAnalysis,
  getHarborFeeAnalysis,
  getContributionAnalysis,
  getDailyRevenueTrend,
  getRouteContribution,
  getDetailedExpenses,
  getActionTypes,
  getFilteredLogs,
  getMergedSummary,
  getVesselPerformanceWithContribution,
  getRouteProfitabilityWithContribution,
  getMergedDepartures,
  getVesselPerformanceMerged,
  getRouteProfitabilityMerged,
  getMergedOperationsSummary,
  getVesselsByRoute,
  formatRouteDisplay
};
</code></pre>
        </article>
    </section>





    
</div>

<br class="clear">

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

</body>
</html>
